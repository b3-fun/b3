---
title: Clientes
description: Gestiona registros de clientes e historial de pagos
lang: es
originalPath: anyspend/api/customers.mdx
---
Los clientes representan a las personas que pagan a través de tus enlaces de pago. Los registros de clientes se crean automáticamente cuando una billetera completa una sesión de pago, pero también puedes crearlos y gestionarlos manualmente a través de la API.

<Info>
  Los campos `name` y `email` del cliente están **cifrados en reposo** para cumplir con la privacidad. Se descifran automáticamente cuando se recuperan a través de la API.
</Info>

## El objeto Cliente

<ResponseField name="id" type="string">
  Identificador único para el cliente (por ejemplo, `cust_abc123`).
</ResponseField>

<ResponseField name="wallet_address" type="string">
  La dirección de billetera del cliente.
</ResponseField>

<ResponseField name="name" type="string | null">
  Nombre del cliente. Cifrado en reposo.
</ResponseField>

<ResponseField name="email" type="string | null">
  Email del cliente. Cifrado en reposo.
</ResponseField>

<ResponseField name="metadata" type="object | null">
  Pares clave-valor arbitrarios para tu propio uso.
</ResponseField>

<ResponseField name="total_spent" type="string">
  Monto total gastado en todas las transacciones completadas (en equivalente USD).
</ResponseField>

<ResponseField name="transaction_count" type="number">
  Número total de transacciones completadas.
</ResponseField>

<ResponseField name="first_seen_at" type="string">
  Marca de tiempo ISO 8601 de la primera transacción del cliente.
</ResponseField>

<ResponseField name="last_seen_at" type="string">
  Marca de tiempo ISO 8601 de la transacción más reciente del cliente.
</ResponseField>

<ResponseField name="created_at" type="string">
  Marca de tiempo de creación ISO 8601.
</ResponseField>

<ResponseField name="updated_at" type="string">
  Marca de tiempo de la última actualización ISO 8601.
</ResponseField>

---

## Listar clientes

Recupera una lista paginada de clientes con búsqueda opcional.

<ParamField query="search" type="string">
  Buscar clientes por dirección de billetera, nombre o email.
</ParamField>

<ParamField query="page" type="number" default={1}>
  Número de página para la paginación.
</ParamField>

<ParamField query="limit" type="number" default={20}>
  Número de resultados por página (máx. 100).
</ParamField>

<CodeGroup>
```bash cURL
curl -X GET "https://platform-api.anyspend.com/api/v1/customers?search=acme&page=1&limit=20" \
  -H "Authorization: Bearer asp_xxx"
```

```typescript SDK
import { AnySpend } from "@b3dotfun/sdk";

const anyspend = new AnySpend(process.env.ANYSPEND_API_KEY!);

const { data, pagination } = await anyspend.customers.list({
  search: "acme",
  page: 1,
  limit: 20,
});
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    ```json
    {
      "data": [
        {
          "id": "cust_abc123",
          "wallet_address": "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
          "name": "Alice Johnson",
          "email": "alice@acme.com",
          "metadata": {
            "company": "Acme Inc.",
            "plan": "pro"
          },
          "total_spent": "250.00",
          "transaction_count": 5,
          "first_seen_at": "2026-01-15T10:30:00Z",
          "last_seen_at": "2026-02-25T14:22:00Z",
          "created_at": "2026-01-15T10:30:00Z",
          "updated_at": "2026-02-25T14:22:00Z"
        }
      ],
      "pagination": {
        "page": 1,
        "limit": 20,
        "total": 1,
        "total_pages": 1,
        "has_more": false
      }
    }
    ```
  </Tab>
</Tabs>

---

## Crear un cliente

Crear manualmente un registro de cliente. Esto es útil para pre-registrar clientes antes de que realicen un pago.

<ParamField body="wallet_address" type="string" required>
  La dirección de billetera del cliente.
</ParamField>

<ParamField body="name" type="string">
  Nombre del cliente. Será cifrado en reposo.
</ParamField>

<ParamField body="email" type="string">
  Email del cliente. Será cifrado en reposo.
</ParamField>

<ParamField body="metadata" type="object">
  Pares clave-valor arbitrarios (por ejemplo, `{"plan": "pro"}`). Hasta 50 claves, valores de 500 caracteres.
</ParamField>

<Warning>
  Si un cliente con la misma `wallet_address` ya existe, la solicitud devolverá un error `409 Conflict`. Usa el endpoint de actualización para modificar clientes existentes.
</Warning>

<CodeGroup>
```bash cURL
curl -X POST "https://platform-api.anyspend.com/api/v1/customers" \
  -H "Authorization: Bearer asp_xxx" \
  -H "Content-Type: application/json" \
  -d '{
    "wallet_address": "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
    "name": "Alice Johnson",
    "email": "alice@acme.com",
    "metadata": {
      "company": "Acme Inc.",
      "plan": "pro"
    }
  }'
```

```typescript SDK
const customer = await anyspend.customers.create({
  walletAddress: "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
  name: "Alice Johnson",
  email: "alice@acme.com",
  metadata: {
    company: "Acme Inc.",
    plan: "pro",
  },
});
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    ```json
    {
      "id": "cust_abc123",
      "wallet_address": "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
      "name": "Alice Johnson",
      "email": "alice@acme.com",
      "metadata": {
        "company": "Acme Inc.",
        "plan": "pro"
      },
      "total_spent": "0.00",
      "transaction_count": 0,
      "first_seen_at": null,
      "last_seen_at": null,
      "created_at": "2026-02-27T10:00:00Z",
      "updated_at": "2026-02-27T10:00:00Z"
    }
    ```
  </Tab>
</Tabs>

---

## Recuperar un cliente

<ParamField path="id" type="string" required>
  El ID del cliente (por ejemplo, `cust_abc123`).
</ParamField>

<CodeGroup>
```bash cURL
curl -X GET "https://platform-api.anyspend.com/api/v1/customers/cust_abc123" \
  -H "Authorization: Bearer asp_xxx"
```

```typescript SDK
const customer = await anyspend.customers.retrieve("cust_abc123");
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    Devuelve el [objeto Cliente](#el-objeto-cliente) completo.
  </Tab>
</Tabs>

---

## Actualizar un cliente

Actualiza un cliente existente. Solo se actualizarán los campos que incluyas en el cuerpo de la solicitud.

<ParamField path="id" type="string" required>
  El ID del cliente.
</ParamField>

<ParamField body="name" type="string">
  Nombre del cliente actualizado.
</ParamField>

<ParamField body="email" type="string">
  Email del cliente actualizado.
</ParamField>

<ParamField body="metadata" type="object">
  Metadatos actualizados. Esto **reemplaza** el objeto de metadatos completo. Para agregar una sola clave, incluye los metadatos existentes completos más la nueva clave.
</ParamField>

<Tip>
  La `wallet_address` no se puede cambiar después de la creación. Para asociar un cliente con una billetera diferente, crea un nuevo registro de cliente.
</Tip>

<CodeGroup>
```bash cURL
curl -X PATCH "https://platform-api.anyspend.com/api/v1/customers/cust_abc123" \
  -H "Authorization: Bearer asp_xxx" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Alice Johnson-Smith",
    "metadata": {
      "company": "Acme Inc.",
      "plan": "enterprise",
      "upgraded_at": "2026-02-27"
    }
  }'
```

```typescript SDK
const updated = await anyspend.customers.update("cust_abc123", {
  name: "Alice Johnson-Smith",
  metadata: {
    company: "Acme Inc.",
    plan: "enterprise",
    upgraded_at: "2026-02-27",
  },
});
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    Devuelve el [objeto Cliente](#el-objeto-cliente) actualizado.
  </Tab>
</Tabs>

---

## Eliminar un cliente

Eliminar permanentemente un registro de cliente. El historial de transacciones asociado con este cliente se conserva, pero la referencia del cliente aparecerá como eliminada.

<ParamField path="id" type="string" required>
  El ID del cliente.
</ParamField>

<Warning>
  Esta acción es irreversible. Toda la información personal identificable (nombre, email) se eliminará permanentemente.
</Warning>

<CodeGroup>
```bash cURL
curl -X DELETE "https://platform-api.anyspend.com/api/v1/customers/cust_abc123" \
  -H "Authorization: Bearer asp_xxx"
```

```typescript SDK
await anyspend.customers.delete("cust_abc123");
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    ```json
    {
      "id": "cust_abc123",
      "deleted": true
    }
    ```
  </Tab>
</Tabs>

---

## Listar transacciones de clientes

Recupera el historial de transacciones para un cliente específico.

<ParamField path="id" type="string" required>
  El ID del cliente.
</ParamField>

<ParamField query="status" type="string">
  Filtrar por estado de la transacción: `pending`, `confirming`, `completed`, `failed`.
</ParamField>

<ParamField query="page" type="number" default={1}>
  Número de página.
</ParamField>

<ParamField query="limit" type="number" default={20}>
  Resultados por página (máx. 100).
</ParamField>

<CodeGroup>
```bash cURL
curl -X GET "https://platform-api.anyspend.com/api/v1/customers/cust_abc123/transactions?status=completed&page=1&limit=10" \
  -H "Authorization: Bearer asp_xxx"
```

```typescript SDK
const { data, pagination } = await anyspend.customers.transactions("cust_abc123", {
  status: "completed",
  page: 1,
  limit: 10,
});
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    ```json
    {
      "data": [
        {
          "id": "tx_tx001",
          "customer_id": "cust_abc123",
          "payment_link_id": "pl_abc123",
          "session_id": "cs_sess001",
          "status": "completed",
          "amount": "50000000",
          "amount_usd": "50.00",
          "token_address": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
          "chain_id": 1,
          "tx_hash": "0x9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1f0e",
          "payer_address": "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
          "recipient_address": "0x1234567890abcdef1234567890abcdef12345678",
          "created_at": "2026-02-25T08:15:00Z",
          "completed_at": "2026-02-25T08:16:30Z"
        }
      ],
      "pagination": {
        "page": 1,
        "limit": 10,
        "total": 5,
        "total_pages": 1,
        "has_more": false
      }
    }
    ```
  </Tab>
</Tabs>

---

## Exportar clientes

Exporta tus datos de clientes en formato CSV o JSON. La respuesta se transmite como una descarga de archivo.

<ParamField query="format" type="string" required>
  Formato de exportación. Uno de: `csv`, `json`.
</ParamField>

<ParamField query="search" type="string">
  Filtrar clientes exportados por término de búsqueda.
</ParamField>

<Info>
  Las exportaciones están limitadas a 10,000 registros. Para conjuntos de datos más grandes, utiliza la paginación con el endpoint de lista.
</Info>

<CodeGroup>
```bash cURL
# Descargar como CSV
curl -X GET "https://platform-api.anyspend.com/api/v1/customers/export?format=csv" \
  -H "Authorization: Bearer asp_xxx" \
  -o customers.csv

# Descargar como JSON
curl -X GET "https://platform-api.anyspend.com/api/v1/customers/export?format=json" \
  -H "Authorization: Bearer asp_xxx" \
  -o customers.json
```

```typescript SDK
// Obtener exportación como un ReadableStream
const csvStream = await anyspend.customers.export({ format: "csv" });

// O obtener como un array JSON
const customers = await anyspend.customers.export({ format: "json" });
```
</CodeGroup>

<Tabs>
  <Tab title="CSV Response">
    ```csv
    id,wallet_address,name,email,total_spent,transaction_count,first_seen_at,last_seen_at,created_at
    cust_abc123,0xaabb...5678,Alice Johnson,alice@acme.com,250.00,5,2026-01-15T10:30:00Z,2026-02-25T14:22:00Z,2026-01-15T10:30:00Z
    cust_def456,0xccdd...9012,Bob Smith,bob@example.com,100.00,2,2026-02-01T09:00:00Z,2026-02-20T16:45:00Z,2026-02-01T09:00:00Z
    ```
  </Tab>
  <Tab title="JSON Response">
    ```json
    {
      "data": [
        {
          "id": "cust_abc123",
          "wallet_address": "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
          "name": "Alice Johnson",
          "email": "alice@acme.com",
          "total_spent": "250.00",
          "transaction_count": 5,
          "first_seen_at": "2026-01-15T10:30:00Z",
          "last_seen_at": "2026-02-25T14:22:00Z",
          "created_at": "2026-01-15T10:30:00Z"
        }
      ],
      "total": 2
    }
    ```
  </Tab>
</Tabs>
