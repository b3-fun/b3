---
title: Referencia del SDK
description: >-
  Referencia completa de la API para el SDK de BondKit con ejemplos y
  definiciones de TypeScript.
lang: es
originalPath: bondkit/sdk/reference.mdx
---
## Instalación y Configuración

<Tabs>
  <Tab title="Paquete NPM">
    ```bash
    # SDK de Producción
    pnpm add @b3dotfun/sdk
    
    # Importar desde el SDK principal
    import { 
      BondkitTokenFactory, 
      BondkitToken 
    } from "@b3dotfun/sdk/bondkit";
    ```
  </Tab>
  <Tab title="Desarrollo">
    ```bash
    # Clonar el monorepo
    git clone https://github.com/b3dotfun/b3-monorepo.git
    cd b3-monorepo
    pnpm install
    
    # Construir el SDK
    pnpm --filter @b3dotfun/sdk build
    ```
  </Tab>
</Tabs>

## Clases Principales

### BondkitTokenFactory

La clase de fábrica maneja el despliegue de nuevos tokens de bonos y la consulta de tokens desplegados.

```typescript
import { BondkitTokenFactory } from "@b3dotfun/sdk/bondkit";
import { base } from "viem/chains";

const factory = new BondkitTokenFactory(
  base.id,                    // ID de la cadena (Base mainnet)
  process.env.WALLET_KEY      // Opcional: clave privada para escrituras
);
```

#### Constructor

```typescript
constructor(
  chainId: SupportedChainId,
  walletKey?: string
)
```

| Parámetro | Tipo | Requerido | Descripción |
|-----------|------|----------|-------------|
| `chainId` | `number` | Sí | ID de la cadena (actualmente solo Base: 8453) |
| `walletKey` | `string` | No | Clave privada para operaciones de escritura |

#### Métodos

<AccordionGroup>
  <Accordion title="deployBondkitToken">
    **Desplegar un nuevo token de bono**
    
    ```typescript
    async deployBondkitToken(
      config: BondkitTokenConfig
    ): Promise<Address>
    ```
    
    **Parámetros:**
    ```typescript
    interface BondkitTokenConfig {
      name: string;                      // Nombre del token
      symbol: string;                    // Símbolo del token
      feeRecipient: Address;            // Recibe las tarifas de comercio
      finalTokenSupply: bigint;         // Suministro total (18 decimales)
      aggressivenessFactor: number;     // 0-100 inclinación de la curva
      lpSplitRatioFeeRecipientBps: bigint; // Participación de tarifa de LP (puntos básicos)
      targetAmount: bigint;             // Cantidad objetivo en token de comercio (18 decimales)
      migrationAdminAddress: Address;   // Puede activar la migración
      bondingPhaseSplitter: Address;    // Divisor de tarifas de la fase de bonificación
      v4PoolManager: Address;           // Administrador del pool de Uniswap V4
      v4Hook: Address;                  // Gancho personalizado de Uniswap V4
      v4PoolFee: number;                // Nivel de tarifa del pool (3000 = 0.3%)
      v4TickSpacing: number;            // Espaciado de ticks para el pool
      tradingToken: Address;            // Token utilizado para comerciar (B3/ETH/etc)
    }
    ```
    
    **Ejemplo:**
    ```typescript
    const tokenAddress = await factory.deployBondkitToken({
      name: "Mi Token",
      symbol: "MTK",
      feeRecipient: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb1",
      finalTokenSupply: parseEther("1000000"),
      aggressivenessFactor: 50,
      lpSplitRatioFeeRecipientBps: 1000n, // 10%
      targetAmount: parseEther("10"),
      migrationAdminAddress: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb1",
      bondingPhaseSplitter: "0x2AB69e0d9D20D3700466153D84a6574128154Fd2",
      v4PoolManager: "0x498581fF718922c3f8e6A244956aF099B2652b2b",
      v4Hook: "0xB36f4A2FB18b745ef8eD31452781a463d2B3f0cC",
      v4PoolFee: 3000,
      v4TickSpacing: 60,
      tradingToken: "0xB3B32F9f8827D4634fE7d973Fa1034Ec9fdDB3B3"
    });
    ```
  </Accordion>
  
  <Accordion title="getDeployedBondkitTokens">
    **Obtener todos los tokens desplegados**
    
    ```typescript
    async getDeployedBondkitTokens(): Promise<Address[]>
    ```
    
    **Devuelve:** Array de direcciones de tokens
    
    **Ejemplo:**
    ```typescript
    const tokens = await factory.getDeployedBondkitTokens();
    console.log(`Encontrados ${tokens.length} tokens`);
    ```
  </Accordion>
  
  <Accordion title="getBondkitTokenConfig">
    **Obtener configuración del token**
    
    ```typescript
    async getBondkitTokenConfig(
      tokenAddress: Address
    ): Promise<BondkitTokenConfig>
    ```
    
    **Ejemplo:**
    ```typescript
    const config = await factory.getBondkitTokenConfig(
      "0x123..."
    );
    console.log(`Nombre del token: ${config.name}`);
    ```
  </Accordion>
  
  <Accordion title="getImplementationAddress">
    **Obtener contrato de implementación**
    
    ```typescript
    async getImplementationAddress(): Promise<Address>
    ```
    
    **Ejemplo:**
    ```typescript
    const impl = await factory.getImplementationAddress();
    console.log(`Implementación: ${impl}`);
    ```
  </Accordion>
  
  <Accordion title="connect">
    **Conectar proveedor de billetera**
    
    ```typescript
    connect(provider?: EIP1193Provider): boolean
    ```
    
    **Ejemplo:**
    ```typescript
    // Entorno del navegador
    const connected = factory.connect(window.ethereum);
    
    // Proveedor personalizado
    import { custom } from "viem";
    const transport = custom(provider);
    factory.connect(transport);
    ```
  </Accordion>
</AccordionGroup>

### BondkitToken

La clase de token maneja todas las operaciones para un token de bono específico.

```typescript
import { BondkitToken } from "@b3dotfun/sdk/bondkit";

const token = new BondkitToken(
  "0x123...",                 // Dirección del token
  process.env.WALLET_KEY      // Opcional: clave privada
);
```

#### Constructor

```typescript
constructor(
  contractAddress: string,
  walletKey?: string
)
```

| Parámetro | Tipo | Requerido | Descripción |
|-----------|------|----------|-------------|
| `contractAddress` | `string` | Sí | Dirección del contrato del token |
| `walletKey` | `string` | No | Clave privada para operaciones de escritura |

#### Métodos de Lectura

<AccordionGroup>
  <Accordion title="Métodos Estándar ERC20">
    ```typescript
    // Información básica del token
    async name(): Promise<string>
    async symbol(): Promise<string>
    async decimals(): Promise<number>
    async totalSupply(): Promise<bigint>
    
    // Balances
    async balanceOf(address: Address): Promise<bigint>
    async allowance(
      owner: Address, 
      spender: Address
    ): Promise<bigint>
    
    // Ejemplo
    const balance = await token.balanceOf(userAddress);
    console.log(`Balance: ${formatEther(balance)}`);
    ```
  </Accordion>
  
  <Accordion title="Métodos de Curva de Bonificación">
    ```typescript
    // Precio actual por token
    async getCurrentBondingCurvePricePerToken(): Promise<bigint>
    
    // Precio actual en token de comercio
    async getCurrentPrice(): Promise<bigint>
    
    // Cotización para comprar
    async getAmountOfTokensToBuy(
      tradingTokenAmount: bigint | string
    ): Promise<bigint>
    
    // Cotización para vender
    async getAmountOfTradingTokensToSell(
      tokenAmount: bigint
    ): Promise<bigint>
    
    // Progreso de bonificación
    async getBondingProgress(): Promise<{
      progress: number;      // 0-1 (porcentaje)
      raised: number;        // Monto recaudado (convertido a número)
      threshold: number;     // Monto objetivo (convertido a número)
    }>
    
    // Ejemplo
    const progress = await token.getBondingProgress();
    console.log(`Progreso: ${(progress.progress * 100).toFixed(2)}%`);
    ```
  </Accordion>
  
  <Accordion title="Estado y Configuración">
    ```typescript
    // Estado del token
    async getStatus(): Promise<TokenStatus>
    async isMigrated(): Promise<boolean>
    async canMigrate(): Promise<boolean>
    
    // Configuración
    async getOwner(): Promise<Address>
    async getFeeRecipient(): Promise<Address>
    async getAggressivenessFactor(): Promise<number>
    async getTargetAmount(): Promise<bigint>
    
    // Información de migración
    async getMigrationData(): Promise<{
      ethForLp: bigint;
      tokensForLp: bigint;
      sqrtPriceX96: bigint;
    }>
    
    // Ejemplo
    if (await token.canMigrate()) {
      console.log("Listo para migrar!");
    }
    ```
  </Accordion>
  
  <Accordion title="Métodos de Análisis">
    ```typescript
    // Titulares de tokens
    async getPaginatedHolders(
      offset: number,
      limit: number
    ): Promise<{
      holders: Address[];
      total: number;
    }>
    
    // Historial de transacciones (desde API)
    async getTransactionHistory(
      options?: GetTransactionHistoryOptions
    ): Promise<TransactionResponse>
    
    // Interfaz de opciones
    interface GetTransactionHistoryOptions {
      userAddress?: Address;
      type?: "buy" | "sell";
      from?: number;        // Timestamp
      to?: number;          // Timestamp
      limit?: number;       // 1-100
      offset?: number;
    }
    
    // Ejemplo
    const history = await token.getTransactionHistory({
      type: "buy",
      limit: 10
    });
    ```
  </Accordion>
  
  <Accordion title="Métodos de Token de Comercio">
    **Métodos para interactuar con el token de comercio**
    
    ```typescript
    // Obtener dirección del token de comercio (B3/ETH/etc)
    async getTradingTokenAddress(): Promise<Address>
    
    // Obtener símbolo del token de comercio  
    async getTradingTokenSymbol(): Promise<string>
    
    // Obtener balance del token de comercio del usuario
    async getTradingTokenBalanceOf(account: Address): Promise<bigint>
    
    // Verificar estado/fase actual del token
    async currentStatus(): Promise<TokenStatus>
    async getCurrentPhase(): Promise<string>
    
    // Verificar si el intercambio DEX está disponible
    async isSwapAvailable(): Promise<boolean>
    ```
    
    **Ejemplo:**
    ```typescript
    // Verificar qué token de comercio se utiliza
    const tradingTokenAddress = await token.getTradingTokenAddress();
    const tradingTokenSymbol = await token.getTradingTokenSymbol();
    console.log(`Comerciando con: ${tradingTokenSymbol} (${tradingTokenAddress})`);
    
    // Verificar balance del token de comercio del usuario
    const tradingBalance = await token.getTradingTokenBalanceOf(userAddress);
    console.log(`Balance del token de comercio: ${formatEther(tradingBalance)}`);
    
    // Verificar fase actual
    const status = await token.currentStatus();
    if (status === TokenStatus.Dex) {
      console.log("El token está en fase de comercio DEX");
    }
    ```
  </Accordion>
  
  <Accordion title="Métodos de Intercambio de Fase DEX">
    **Métodos de intercambio integrados para comercio en fase DEX**
    
    ```typescript
    // Obtener cotizaciones de intercambio
    async getSwapQuoteForBondkitToken(
      amountTradingTokenIn: string,
      slippageTolerance?: number
    ): Promise<SwapQuote | null>
    
    async getSwapQuoteForTradingToken(
      amountBondkitTokenIn: string, 
      slippageTolerance?: number
    ): Promise<SwapQuote | null>
    
    // Ejecutar intercambios
    async swapTradingTokenForBondkitToken(
      amountTradingTokenIn: string,
      slippageTolerance?: number,
      walletClient: WalletClient
    ): Promise<string | null>
    
    async swapBondkitTokenForTradingToken(
      amountBondkitTokenIn: string,
      slippageTolerance?: number, 
      walletClient: WalletClient
    ): Promise<string | null>
    ```
    
    **Ejemplo:**
    ```typescript
    // Verificar si el intercambio está disponible (solo fase DEX)
    const canSwap = await token.isSwapAvailable();
    if (!canSwap) {
      console.log("Aún en fase de bonificación - usar buy()/sell()");
      return;
    }
    
    // Obtener cotización para intercambiar 100 tokens B3 → tokens bondkit
    const quote = await token.getSwapQuoteForBondkitToken(
      "100",      // 100 tokens de comercio
      0.005       // 0.5% de tolerancia de deslizamiento
    );
    
    if (quote) {
      console.log(`Recibirá: ${quote.amountOut} tokens bondkit`);
      console.log(`Impacto de precio: ${quote.priceImpact}%`);
      
      // Ejecutar el intercambio
      const txHash = await token.swapTradingTokenForBondkitToken(
        "100",
        0.005,
        walletClient
      );
      console.log(`Intercambio completado: ${txHash}`);
    }
    ```
  </Accordion>
</AccordionGroup>

#### Métodos de Escritura

<AccordionGroup>
  <Accordion title="buy">
    **Comprar tokens con token de comercio**
    
    ```typescript
    async buy(
      amount: bigint | string,
      minTokensOut: bigint
    ): Promise<Hex>
    ```
    
    **Parámetros:**
    - `amount`: Cantidad de token de comercio a gastar (como string o bigint) 
    - `minTokensOut`: Mínimo de tokens a recibir (protección contra deslizamiento)
    
    **Ejemplo:**
    ```typescript
    // Obtener cotización primero
    const quote = await token.getAmountOfTokensToBuy(
      parseEther("100") // 100 tokens de comercio
    );
    
    // Comprar con 5% de tolerancia de deslizamiento
    const minTokens = quote * 95n / 100n;
    const txHash = await token.buy(
      parseEther("100"), // amount: 100 tokens de comercio
      minTokens          // minTokensOut: protección contra deslizamiento
    );
    
    console.log(`Transacción: ${txHash}`);
    ```
  </Accordion>
  
  <Accordion title="sell">
    **Vender tokens por token de comercio**
    
    ```typescript
    async sell(
      tokenAmount: bigint,
      minTradingTokenOut: bigint
    ): Promise<Hex>
    ```
    
    **Parámetros:**
    - `tokenAmount`: Cantidad de tokens a vender
    - `minTradingTokenOut`: Mínimo de token de comercio a recibir (protección contra deslizamiento)
    
    **Ejemplo:**
    ```typescript
    // Vender 1000 tokens
    const sellAmount = parseEther("1000");
    
    // Obtener cotización
    const quote = await token.getAmountOfTradingTokensToSell(sellAmount);
    
    // Vender con protección contra deslizamiento
    const minTradingTokenOut = quote * 95n / 100n;
    const txHash = await token.sell(sellAmount, minTradingTokenOut);
    ```
  </Accordion>
  
  <Accordion title="migrateToDex">
    **Migrar a Uniswap v4**
    
    ```typescript
    async migrateToDex(): Promise<Hex>
    ```
    
    **Requisitos:**
    - El llamador debe ser el administrador de migración
    - Se debe alcanzar el objetivo
    
    **Ejemplo:**
    ```typescript
    if (await token.canMigrate()) {
      const txHash = await token.migrateToDex();
      console.log(`Tx de migración: ${txHash}`);
    }
    ```
  </Accordion>
  
  <Accordion title="Métodos de Propiedad">
    **Transferir o renunciar a la propiedad del token**
    
    ```typescript
    // Transferir propiedad a nueva dirección
    async transferTokenOwnership(
      newOwner: Address
    ): Promise<Hex>
    
    // Renunciar a la propiedad (irreversible)
    async renounceTokenOwnership(): Promise<Hex>
    ```
    
    **Ejemplo:**
    ```typescript
    // Transferir propiedad a multisig
    const multisig = "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb1";
    await token.transferTokenOwnership(multisig);
    
    // O renunciar completamente a la propiedad (¡ten cuidado!)
    await token.renounceTokenOwnership();
    ```
    
    <Warning>
      **Importante**: Renunciar a la propiedad es irreversible y elimina todas las capacidades de administración. Solo haz esto después de la migración o si deseas hacer el token completamente descentralizado.
    </Warning>
  </Accordion>
  
  <Accordion title="Métodos de Escritura ERC20">
    ```typescript
    // Transferencias estándar
    async transfer(
      to: Address,
      amount: bigint
    ): Promise<Hex>
    
    async transferFrom(
      from: Address,
      to: Address,
      amount: bigint
    ): Promise<Hex>
    
