---
title: Fasilitator AnySpend
description: Prosesor pembayaran kelas produksi untuk pembayaran multi-token x402
lang: id
originalPath: anyspend/x402-facilitator.mdx
---
<CardGroup cols={2}>
<Card title="Repositori GitHub" icon="github" href="https://github.com/b3-fun/anyspend-x402">
  Lihat kode sumber, contoh, dan berkontribusi
</Card>

<Card title="Paket npm" icon="npm" href="https://www.npmjs.com/package/@b3dotfun/anyspend-x402">
  Pasang paket @b3dotfun/anyspend-x402
</Card>
</CardGroup>

## Ikhtisar

Fasilitator AnySpend x402 adalah infrastruktur pembayaran produksi-grade yang mendukung pembayaran multi-token, lintas-rantai untuk protokol x402. Ini menangani semua kompleksitas pertukaran token, jembatan lintas-rantai, dan penyelesaian, memungkinkan pengembang untuk menerima pembayaran dalam token apa pun sambil menerima mata uang yang mereka pilih.

**Endpoint Produksi:** `https://mainnet.anyspend.com/x402`

## Kemampuan Utama

### Pengolahan Pembayaran Multi-Token

Terima pembayaran dalam token ERC-20 apa pun yang mendukung EIP-2612 (permit) atau EIP-3009 (transferWithAuthorization):

- **Stablecoins**: USDC, DAI, USDT (di rantai yang didukung)
- **Token asli**: ETH, SOL, BNB, MATIC
- **Token kustom**: Token apa pun dengan dukungan permit, termasuk token proyek seperti B3
- **19+ Jaringan**: Dukungan lintas rantai EVM (Base, Ethereum, Arbitrum, dll.) dan SVM (Solana)

### Routing Lintas-Rantai

Secara otomatis menangani pembayaran lintas berbagai jaringan blockchain:

- **Pembayaran rantai yang sama**: Transfer token langsung dengan overhead minimal
- **Pembayaran lintas-rantai**: Jembatan otomatis antar jaringan (mis., ETH → Base)
- **Pembayaran lintas-VM**: Dukungan eksperimental untuk transfer Solana ↔ EVM
- **Routing optimal**: Pemilihan rute cerdas untuk eksekusi terbaik

### Konversi Token Otomatis

Mengonversi secara mulus antara token yang didukung:

- **Fleksibilitas pembeli**: Pengguna membayar dengan token apa pun yang mereka miliki
- **Preferensi penjual**: Pedagang menerima mata uang penyelesaian yang mereka pilih
- **Harga terbaik**: Rute melalui sumber likuiditas DEX optimal
- **Perlindungan slippage**: Pengaman otomatis terhadap dampak harga

### Pembayaran Tanpa Gas

Pengguna tidak pernah membayar biaya gas:

- Fasilitator menanggung semua biaya gas on-chain
- Pengguna hanya menandatangani pesan EIP-712
- Tidak perlu memegang token asli untuk gas
- Pengalaman pengguna yang lancar di semua rantai

## Kepatuhan Standar

### Sesuai Protokol x402

Fasilitator AnySpend mengimplementasikan spesifikasi x402 lengkap:

- ✅ **Pembayaran native HTTP** via status `402 Payment Required`
- ✅ **Header standar** (`X-PAYMENT`, `X-PAYMENT-RESPONSE`, `X-PREFERRED-TOKEN`)
- ✅ **Skema pembayaran yang tepat** dengan verifikasi penerima dan jumlah
- ✅ **Otorisasi berbasis tanda tangan** (EIP-712, EIP-2612, EIP-3009)
- ✅ **Verifikasi kriptografis** tanpa pihak ketiga yang dipercaya

### Pengganti Langsung

Sepenuhnya kompatibel dengan implementasi x402 apa pun:

- **Kompatibilitas klien**: Bekerja dengan klien yang sesuai x402
- **Kompatibilitas server**: Dapat digunakan dengan perangkat lunak antara x402 apa pun
- **Tidak ada kunci vendor**: API HTTP standar, beralih fasilitator kapan saja
- **Interoperabilitas**: Terintegrasi dengan Coinbase CDP x402, PayAI, dan lainnya

## Arsitektur

### Alur Pembayaran

```
┌──────────────┐
│    Klien     │  Menandatangani otorisasi pembayaran
│  (Token Apa Pun) │  preferredToken: DAI
└──────┬───────┘
       │
       │ Header X-PAYMENT
       ▼
┌──────────────────────────┐
│   Server Sumber Daya     │
│   (API Anda)             │
│                          │
│  Middleware AnySpend     │
│  • Menangkap permintaan  │
│  • Mendapatkan kutipan   │
│  • Mengembalikan 402     │
└──────┬───────────────────┘
       │
       │ /verify, /settle
       ▼
┌──────────────────────────┐
│  Fasilitator AnySpend    │
│  mainnet.anyspend.com    │
│                          │
│  • Memvalidasi tanda tangan │
│  • Melaksanakan pertukaran token │
│  • Menyelesaikan ke penjual │
└──────┬───────────────────┘
       │
       │ Transaksi on-chain
       ▼
┌──────────────────────────┐
│      Blockchain          │
│  • Menerima pembayaran   │
│  • Menukar token (jika diperlukan) │
│  • Menyelesaikan ke pedagang │
└──────────────────────────┘
```

### Komponen Infrastruktur

**Lapisan API**
- API HTTP RESTful untuk verifikasi pembayaran dan penyelesaian
- Dukungan WebSocket untuk pembaruan status pembayaran real-time
- Pembatasan laju dan perlindungan DDoS
- SLA uptime 99,9%

**Mesin Swap**
- Mengagregasi likuiditas dari beberapa DEX
- Routing optimal untuk harga eksekusi terbaik
- Perlindungan slippage dan resistensi MEV
- Integrasi jembatan lintas-rantai

**Sistem Penyelesaian**
- Pengolahan transaksi paralel
- Manajemen nonce otomatis
- Pemulihan transaksi gagal
- Konfirmasi penyelesaian real-time

**Keamanan**
- Verifikasi tanda tangan EIP-712
- Pencegahan serangan replay (pelacakan nonce)
- Penegakan batas waktu
- Audit kontrak pintar

## Endpoint API

### POST /verify

Memvalidasi tanda tangan pembayaran tanpa eksekusi on-chain.

**Tujuan:**
- Validasi cepat (di bawah 100ms)
- Memeriksa keaslian tanda tangan
- Memverifikasi batas waktu belum berakhir
- Tanpa biaya gas

**Permintaan:**
```json
{
  "x402Version": "0.2",
  "paymentHeader": "base64_encoded_payment",
  "paymentRequirements": {
    "scheme": "exact",
    "network": "base-mainnet",
    "amount": "1000000",
    "asset": "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",
    "recipient": "0xMerchantAddress..."
  }
}
```

**Respon:**
```json
{
  "valid": true
}
```

---

### POST /settle

Menjalankan penyelesaian on-chain dan mengembalikan bukti transaksi.

**Tujuan:**
- Menjalankan otorisasi pembayaran
- Menukar token jika diperlukan (token pembeli → token penjual)
- Menyelesaikan ke server sumber daya
- Mengembalikan hash transaksi untuk verifikasi

**Permintaan:**
```json
{
  "x402Version": "0.2",
  "paymentHeader": "base64_encoded_payment",
  "paymentRequirements": { /* ... */ }
}
```

**Respon:**
```json
{
  "txHash": "0xabc123...",
  "network": "base-mainnet",
  "metadata": {
    "receiptTxHash": "0x...",
    "swapTxHash": "0x...",
    "settlementTxHash": "0x..."
  }
}
```

---

### POST /quote

Dapatkan tingkat konversi token untuk pembayaran multi-token.

**Tujuan:**
- Menghitung jumlah token yang tepat untuk pembayaran
- Mendapatkan tingkat tukar saat ini
- Memperkirakan waktu eksekusi swap

**Permintaan:**
```json
{
  "usdcAmount": "1000000",        // Jumlah target (1 USDC)
  "paymentToken": "0x50c5...",    // Alamat DAI
  "network": "base-mainnet"
}
```

**Respon:**
```json
{
  "tokenAmount": "1000000000000000000",  // 1.0 DAI diperlukan
  "exchangeRate": "1.0",
  "deadline": 1730000000,
  "route": {
    "srcToken": "0x50c5...",
    "dstToken": "0x8335...",
    "path": ["DAI", "USDC"]
  }
}
```

---

### GET /supported

Menyebutkan skema pembayaran dan jaringan yang didukung.

**Respon:**
```json
{
  "schemes": [{
    "scheme": "exact",
    "networks": [
      "base",
      "ethereum",
      "arbitrum",
      "optimism",
      "polygon",
      "bsc",
      "avalanche",
      "solana"
    ]
  }]
}
```

## Integrasi

### Server-Side (Express)

```typescript
import { paymentMiddleware, facilitator } from '@b3dotfun/anyspend-x402';

const endpointConfig = {
  '/api/premium': {
    amount: '1.00',
    asset: 'USD'
  }
};

app.use(paymentMiddleware(
  '0xAlamatAnda...',
  endpointConfig,
  facilitator  // Dikonfigurasi sebelumnya ke mainnet.anyspend.com/x402
));
```

### Server-Side (Custom)

```typescript
import { X402Facilitator } from '@b3dotfun/anyspend-x402';

const facilitator = new X402Facilitator({
  url: 'https://mainnet.anyspend.com/x402',
  apiKey: process.env.ANYSPEND_API_KEY  // Opsional
});

// Verifikasi pembayaran
const { valid } = await facilitator.verify(paymentHeader, requirements);

// Menyelesaikan pembayaran
const { txHash } = await facilitator.settle(paymentHeader, requirements);
```

### Client-Side

```typescript
import { X402Client } from 'anyspend-x402-client';

const client = new X402Client({
  walletClient,
  facilitatorUrl: 'https://mainnet.anyspend.com/x402'  // Opsional, menggunakan ini secara default
});

const response = await client.request('https://api.example.com/premium');
```

## Keamanan

### Verifikasi Tanda Tangan

Semua pembayaran diverifikasi menggunakan tanda tangan data bertipe EIP-712:

- **USDC**: EIP-3009 `transferWithAuthorization`
- **Token lain**: EIP-2612 `permit`

Tanda tangan divalidasi sebelum eksekusi on-chain apa pun.

### Perlindungan Replay

**Nonce Acak (USDC):**
- Setiap tanda tangan mencakup nonce bytes32 unik
- Nonce hanya dapat digunakan sekali per alamat
- Tidak ada ketergantungan urutan

**Nonce Berurutan (Permit):**
- Kontrak token memelihara penghitung nonce
- Auto-increment pada setiap eksekusi permit
- Mencegah eksekusi yang tidak berurutan

### Penegakan Batas Waktu

Semua tanda tangan mencakup timestamp kedaluwarsa:
- Default: 5 menit dari waktu tanda tangan
- Mencegah otorisasi pembayaran yang kedaluwarsa
- Penolakan otomatis tanda tangan yang kedaluwarsa

### Tidak Ada Akses Kunci Pribadi

Fasilitator **tidak pernah** memiliki akses ke kunci pribadi pengguna:
- Pengguna menandatangani pesan di sisi klien
- Hanya tanda tangan yang ditransmisikan
- Arsitektur non-custodial

## Kinerja

### Kecepatan

- **Verifikasi**: Di bawah 100ms untuk validasi tanda tangan
- **Penyelesaian rantai yang sama**: 2-10 detik rata-rata
- **Penyelesaian lintas-rantai**: 2-5 menit (tergantung pada jembatan)
- **Pembuatan kutipan**: Di bawah 200ms

### Skalabilitas

- Menangani 1000+ pembayaran bersamaan
- Skalabilitas horizontal untuk throughput tinggi
- Pengolahan transaksi paralel
- Load balancing di beberapa node

### Keandalan

- Jaminan uptime 99,9%
- Failover otomatis dan redundansi
- Logika pengulangan transaksi gagal
- Pemantauan dan peringatan 24/7

## Dukungan Jaringan

### Jaringan EVM Mainnet (12)

Abstract, Arbitrum, Avalanche, B3, Base, BNB Chain, Ethereum, IoTeX, Optimism, Peaq, Polygon, Sei

### Jaringan EVM Testnets (5)

Abstract Testnet, Avalanche Fuji, Base Sepolia, Polygon Amoy, Sei Testnet

### Jaringan SVM (2)

Solana Mainnet, Solana Devnet

Lihat [Dukungan Jaringan](/anyspend/x402-network-support) untuk detail lengkap.

## Mengapa Memilih Fasilitator AnySpend?

<CardGroup cols={2}>
<Card title="Sesuai Standar" icon="check-circle">
  Kepatuhan protokol x402 penuh - bekerja dengan klien atau server yang kompatibel apa pun
</Card>

<Card title="Siap Produksi" icon="rocket">
  Infrastruktur yang telah diuji dalam pertempuran dengan keandalan dan kinerja tingkat perusahaan
</Card>

<Card title="Multi-Rantai" icon="globe">
  Dukungan untuk 19+ jaringan blockchain dengan routing lintas-rantai otomatis
</Card>

<Card title="Ramah Pengembang" icon="code">
  API dan SDK sederhana untuk Express, Next.js, Hono, dan TypeScript sisi klien
</Card>
</CardGroup>

## Memulai

<CardGroup cols={2}>
<Card title="Panduan Cepat untuk Penjual" icon="money-bill" href="/anyspend/x402-quickstart-sellers">
  Mulai menerima pembayaran multi-token di API Anda
</Card>

<Card title="Panduan Cepat untuk Pembeli" icon="wallet" href="/anyspend/x402-quickstart-buyers">
  Bayar dengan token apa pun menggunakan klien AnySpend
</Card>

<Card title="Dukungan Jaringan" icon="network-wired" href="/anyspend/x402-network-support">
  Lihat semua jaringan dan token yang didukung
</Card>

<Card title="Ikhtisar" icon="book" href="/anyspend/x402-overview">
  Pelajari cara kerja AnySpend x402
</Card>
</CardGroup>

## Dukungan

Butuh bantuan dengan fasilitator?

- **Discord**: [discord.gg/b3dotfun](https://discord.gg/b3dotfun)
- **GitHub**: [github.com/b3-fun/anyspend-x402](https://github.com/b3-fun/anyspend-x402)
- **Email**: support@b3.fun
- **Dokumentasi**: [docs.b3.fun](https://docs.b3.fun)
