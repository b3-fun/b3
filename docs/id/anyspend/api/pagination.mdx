---
title: Paginasi & Penyaringan
description: Melakukan paginasi melalui endpoint daftar dan menyaring hasil
lang: id
originalPath: anyspend/api/pagination.mdx
---
# Pagination & Filtering

Semua endpoint daftar di AnySpend Platform API mengembalikan respons yang dipaginasi. Halaman ini membahas cara menavigasi set hasil yang besar, memfilter data, dan mengurutkan hasil.

## Format respons daftar

Setiap endpoint daftar mengembalikan amplop yang konsisten:

```json
{
  "object": "list",
  "data": [
    { "object": "payment_link", "id": "pl_abc123...", "name": "Premium Membership" },
    { "object": "payment_link", "id": "pl_def456...", "name": "Basic Plan" }
  ],
  "has_more": true,
  "total_count": 142,
  "url": "/api/v1/payment-links"
}
```

| Field       | Type     | Description |
|-------------|----------|-------------|
| `object`    | `string` | Selalu `"list"` untuk respons daftar. |
| `data`      | `array`  | Array dari objek sumber daya untuk halaman saat ini. Setiap item termasuk field tipe `object` sendiri. |
| `has_more`  | `boolean`| `true` jika ada lebih banyak hasil di luar halaman ini. Gunakan ini untuk menentukan apakah akan mengambil halaman berikutnya. |
| `total_count`| `number`| Jumlah total sumber daya yang cocok di semua halaman. |
| `url`       | `string` | Path endpoint API untuk daftar ini. |

## Parameter Pagination

Gunakan parameter query `page` dan `limit` untuk menavigasi melalui hasil.

| Parameter | Type      | Default | Max  | Description |
|-----------|-----------|---------|------|-------------|
| `page`    | `integer` | `1`     | --   | Nomor halaman yang akan diambil (diindeks 1). |
| `limit`   | `integer` | `20`    | `100`| Jumlah hasil per halaman. |

### Contoh pagination dasar

```bash
# Halaman pertama (default: 20 hasil)
curl "https://platform-api.anyspend.com/api/v1/payment-links" \
  -H "Authorization: Bearer asp_live_abc123..."

# Halaman kedua, 50 hasil per halaman
curl "https://platform-api.anyspend.com/api/v1/payment-links?page=2&limit=50" \
  -H "Authorization: Bearer asp_live_abc123..."
```

### Menavigasi halaman

Gunakan field `has_more` untuk menentukan kapan berhenti melakukan paginasi:

```typescript
async function fetchAllPaymentLinks(): Promise<PaymentLink[]> {
  const allLinks: PaymentLink[] = [];
  let page = 1;
  let hasMore = true;

  while (hasMore) {
    const response = await fetch(
      `https://platform-api.anyspend.com/api/v1/payment-links?page=${page}&limit=100`,
      {
        headers: {
          "Authorization": `Bearer ${process.env.ANYSPEND_API_KEY}`,
        },
      }
    );

    const body = await response.json();
    allLinks.push(...body.data);
    hasMore = body.has_more;
    page++;
  }

  return allLinks;
}
```

## Filtering

Sebagian besar endpoint daftar mendukung parameter query untuk memfilter hasil. Filter yang tersedia tergantung pada jenis sumber daya.

### Payment Links

| Parameter | Type                 | Description |
|-----------|----------------------|-------------|
| `search`  | `string`             | Cari berdasarkan nama atau kode singkat (cocok sebagian). |
| `active`  | `"true"` atau `"false"` | Filter berdasarkan status aktif/tidak aktif. |

```bash
# Mencari payment links yang mengandung "premium"
curl "https://platform-api.anyspend.com/api/v1/payment-links?search=premium" \
  -H "Authorization: Bearer asp_live_abc123..."

# Hanya payment links yang aktif
curl "https://platform-api.anyspend.com/api/v1/payment-links?active=true" \
  -H "Authorization: Bearer asp_live_abc123..."

# Menggabungkan filter
curl "https://platform-api.anyspend.com/api/v1/payment-links?search=premium&active=true&limit=10" \
  -H "Authorization: Bearer asp_live_abc123..."
```

### Checkout Sessions

| Parameter | Type                         | Description |
|-----------|------------------------------|-------------|
| `status`  | `"active"`, `"completed"`, `"expired"` | Filter sesi berdasarkan status. |

```bash
# Sesi yang telah selesai untuk payment link
curl "https://platform-api.anyspend.com/api/v1/payment-links/pl_abc123/sessions?status=completed" \
  -H "Authorization: Bearer asp_live_abc123..."
```

### Transactions

| Parameter | Type     | Description |
|-----------|----------|-------------|
| `status`  | `string` | Filter berdasarkan status transaksi. |
| `chain_id`| `number` | Filter berdasarkan jaringan blockchain. |

```bash
# Transaksi di Base (chain ID 8453)
curl "https://platform-api.anyspend.com/api/v1/transactions?chain_id=8453" \
  -H "Authorization: Bearer asp_live_abc123..."
```

## Sorting

Endpoint daftar yang mendukung pengurutan menerima parameter `sort` dan `order`.

| Parameter | Type     | Default     | Description |
|-----------|----------|-------------|-------------|
| `sort`    | `string` | `created_at`| Field untuk diurutkan. Nilai yang diizinkan bervariasi berdasarkan sumber daya. |
| `order`   | `"asc"` atau `"desc"` | `desc` | Arah pengurutan. |

### Payment Links sort fields

| Field         | Description |
|---------------|-------------|
| `created_at`  | Kapan payment link dibuat (default). |
| `updated_at`  | Kapan payment link terakhir diubah. |
| `name`        | Abjad berdasarkan nama. |
| `current_uses`| Jumlah checkout yang telah selesai. |

```bash
# Payment links paling populer terlebih dahulu
curl "https://platform-api.anyspend.com/api/v1/payment-links?sort=current_uses&order=desc" \
  -H "Authorization: Bearer asp_live_abc123..."

# Abjad berdasarkan nama
curl "https://platform-api.anyspend.com/api/v1/payment-links?sort=name&order=asc" \
  -H "Authorization: Bearer asp_live_abc123..."
```

## Contoh auto-pagination

Untuk kenyamanan, Anda dapat membangun iterator asinkron yang menangani pagination secara otomatis:

```typescript
async function* paginate<T>(
  endpoint: string,
  params: Record<string, string> = {},
  limit = 100,
): AsyncGenerator<T> {
  let page = 1;
  let hasMore = true;

  while (hasMore) {
    const queryParams = new URLSearchParams({
      ...params,
      page: String(page),
      limit: String(limit),
    });

    const response = await fetch(
      `https://platform-api.anyspend.com/api/v1/${endpoint}?${queryParams}`,
      {
        headers: {
          "Authorization": `Bearer ${process.env.ANYSPEND_API_KEY}`,
        },
      }
    );

    const body = await response.json();

    for (const item of body.data) {
      yield item as T;
    }

    hasMore = body.has_more;
    page++;
  }
}

// Penggunaan dengan for-await
async function main() {
  for await (const link of paginate<PaymentLink>("payment-links", { active: "true" })) {
    console.log(`${link.name}: ${link.current_uses} penyelesaian`);
  }
}
```

## Menghitung hasil

Gunakan `total_count` dari halaman mana pun untuk mendapatkan jumlah total sumber daya yang cocok tanpa mengambil semua halaman:

```typescript
async function countActivePaymentLinks(): Promise<number> {
  const response = await fetch(
    "https://platform-api.anyspend.com/api/v1/payment-links?active=true&limit=1",
    {
      headers: {
        "Authorization": `Bearer ${process.env.ANYSPEND_API_KEY}`,
      },
    }
  );

  const body = await response.json();
  return body.total_count;
}
```

Mengatur `limit=1` meminimalkan payload respons ketika Anda hanya membutuhkan jumlahnya.

## Praktik terbaik

<AccordionGroup>
<Accordion title="Gunakan limit=100 untuk operasi massal">
Ketika Anda perlu mengambil semua catatan (misalnya, untuk ekspor data atau sinkronisasi), gunakan `limit=100` maksimum untuk meminimalkan jumlah panggilan API dan tetap dalam batas tarif.
</Accordion>

<Accordion title="Gunakan has_more bukan total_count untuk loop pagination">
`has_more` adalah sinyal otoritatif untuk apakah akan mengambil halaman berikutnya. Hindari menghitung jumlah halaman dari `total_count` karena total dapat berubah antar permintaan.
</Accordion>

<Accordion title="Cache total_count untuk kontrol pagination UI">
Ketika membangun UI pagination (misalnya, "Halaman 3 dari 8"), ambil `total_count` sekali dan cache untuk sesi. Ambil ulang hanya ketika pengguna menyegarkan atau menerapkan filter baru.
</Accordion>

<Accordion title="Gabungkan filter dengan pagination">
Terapkan filter sebelum melakukan paginasi untuk mengurangi set hasil. Ini lebih efisien daripada mengambil semua catatan dan memfilter di sisi klien:

```bash
# Daripada mengambil semua link dan memfilter secara lokal...
# Filter di sisi server dan paginasi hasil yang difilter
curl "https://platform-api.anyspend.com/api/v1/payment-links?active=true&search=premium&limit=20" \
  -H "Authorization: Bearer asp_live_abc123..."
```
</Accordion>

<Accordion title="Hormati batas tarif selama pengambilan massal">
Jika Anda melakukan paginasi melalui dataset yang besar, perhatikan batas tarif 120 permintaan/menit. Untuk dataset yang sangat besar, tambahkan jeda singkat antara permintaan halaman:

```typescript
async function fetchWithDelay() {
  for await (const link of paginate("payment-links")) {
    process.stdout.write(".");
  }
  // Fungsi paginate membuat paling banyak ceil(total / 100) permintaan.
  // Untuk 10.000 catatan, itu adalah 100 permintaan -- dalam batas 120/menit.
}
```
</Accordion>
</AccordionGroup>
