---
title: Sesi Pembayaran
description: Manajemen sesi checkout sisi server untuk alur pembayaran secara programatis
lang: id
originalPath: anyspend/api/checkout-sessions-api.mdx
---
Sesi checkout mewakili upaya pembayaran individu. Anda dapat membuat sesi di sisi server untuk menghasilkan URL checkout unik untuk setiap pelanggan, mengisi detail pembayaran sebelumnya, dan melacak konversi dengan ID referensi Anda sendiri.

<Info>
  Sesi checkout kedaluwarsa setelah 30 menit secara default. Gunakan parameter `expires_in` untuk menyesuaikan jendela kedaluwarsa (minimum 5 menit, maksimum 24 jam).
</Info>

## Objek Sesi Checkout

<ResponseField name="id" type="string">
  Pengenal unik untuk sesi checkout (mis., `cs_abc123`).
</ResponseField>

<ResponseField name="url" type="string">
  URL checkout untuk mengarahkan pelanggan.
</ResponseField>

<ResponseField name="status" type="string">
  Status saat ini dari sesi. Salah satu dari: `open`, `processing`, `completed`, `expired`, `failed`.
</ResponseField>

<ResponseField name="payment_link_id" type="string | null">
  ID tautan pembayaran yang terkait, jika sesi dibuat dari tautan pembayaran.
</ResponseField>

<ResponseField name="product_id" type="string | null">
  ID produk yang terkait.
</ResponseField>

<ResponseField name="token_address" type="string">
  Alamat kontrak dari token yang diterima.
</ResponseField>

<ResponseField name="chain_id" type="number">
  Chain ID tempat Anda ingin menerima pembayaran.
</ResponseField>

<ResponseField name="recipient_address" type="string">
  Alamat dompet yang menerima pembayaran.
</ResponseField>

<ResponseField name="amount" type="string">
  Jumlah pembayaran dalam unit terkecil token.
</ResponseField>

<ResponseField name="amount_usd" type="string | null">
  Setara USD pada saat pembuatan sesi.
</ResponseField>

<ResponseField name="success_url" type="string | null">
  URL yang diarahkan pelanggan setelah pembayaran berhasil. Mendukung variabel template.
</ResponseField>

<ResponseField name="cancel_url" type="string | null">
  URL yang diarahkan pelanggan jika mereka membatalkan.
</ResponseField>

<ResponseField name="client_reference_id" type="string | null">
  ID referensi internal Anda untuk sesi ini.
</ResponseField>

<ResponseField name="metadata" type="object | null">
  Pasangan kunci-nilai sembarang yang dilewatkan ke webhook dan transaksi.
</ResponseField>

<ResponseField name="customer_email" type="string | null">
  Alamat email pelanggan. Di-enkripsi saat istirahat, termasuk dalam payload webhook.
</ResponseField>

<ResponseField name="customer_name" type="string | null">
  Nama pelanggan. Di-enkripsi saat istirahat, termasuk dalam payload webhook.
</ResponseField>

<ResponseField name="payer_address" type="string | null">
  Alamat dompet pembayar (diisi setelah koneksi).
</ResponseField>

<ResponseField name="tx_hash" type="string | null">
  Hash transaksi on-chain (diisi setelah pengajuan).
</ResponseField>

<ResponseField name="customer_id" type="string | null">
  ID pelanggan yang terkait (diisi setelah pembayaran).
</ResponseField>

<ResponseField name="form_data" type="object | null">
  Data formulir kustom yang dikirim oleh pelanggan.
</ResponseField>

<ResponseField name="shipping_address" type="object | null">
  Alamat pengiriman yang disediakan oleh pelanggan.
</ResponseField>

<ResponseField name="utm_source" type="string | null">
  Parameter sumber UTM untuk atribusi.
</ResponseField>

<ResponseField name="utm_medium" type="string | null">
  Parameter medium UTM untuk atribusi.
</ResponseField>

<ResponseField name="utm_campaign" type="string | null">
  Parameter kampanye UTM untuk atribusi.
</ResponseField>

<ResponseField name="expires_at" type="string">
  Cap waktu kedaluwarsa ISO 8601.
</ResponseField>

<ResponseField name="created_at" type="string">
  Cap waktu pembuatan ISO 8601.
</ResponseField>

<ResponseField name="completed_at" type="string | null">
  Cap waktu penyelesaian ISO 8601.
</ResponseField>

### Status Sesi

| Status | Deskripsi |
|--------|-------------|
| `open` | Sesi aktif dan menunggu pelanggan untuk membayar. |
| `processing` | Pelanggan telah memulai pembayaran; transaksi sedang diproses on-chain. |
| `completed` | Pembayaran dikonfirmasi dan diterima oleh penerima. |
| `expired` | Sesi kedaluwarsa sebelum pelanggan menyelesaikan pembayaran. |
| `failed` | Pembayaran gagal karena kesalahan on-chain atau waktu habis. |

### Variabel template URL

Field `success_url` dan `cancel_url` mendukung variabel template yang diganti dengan nilai sebenarnya ketika pelanggan diarahkan:

| Variabel | Deskripsi | Contoh |
|----------|-------------|---------|
| `{SESSION_ID}` | ID sesi checkout | `cs_abc123` |

<Tip>
  Gunakan variabel template untuk mencari detail sesi di server Anda setelah pengalihan:
  `https://example.com/success?session_id={SESSION_ID}`
</Tip>

---

## Daftar sesi checkout

Ambil daftar sesi checkout yang dipaginasi.

<ParamField query="status" type="string">
  Filter berdasarkan status sesi: `open`, `processing`, `completed`, `expired`, `failed`.
</ParamField>

<ParamField query="payment_link_id" type="string">
  Filter berdasarkan ID tautan pembayaran.
</ParamField>

<ParamField query="page" type="number" default={1}>
  Nomor halaman untuk paginasi.
</ParamField>

<ParamField query="limit" type="number" default={20}>
  Jumlah hasil per halaman (maks 100).
</ParamField>

<CodeGroup>
```bash cURL
curl -X GET "https://platform-api.anyspend.com/api/v1/checkout-sessions?status=completed&page=1&limit=20" \
  -H "Authorization: Bearer asp_xxx"
```

```typescript SDK
import { AnySpend } from "@b3dotfun/sdk";

const anyspend = new AnySpend(process.env.ANYSPEND_API_KEY!);

const { data, pagination } = await anyspend.checkoutSessions.list({
  status: "completed",
  page: 1,
  limit: 20,
});
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    ```json
    {
      "data": [
        {
          "id": "cs_abc123",
          "url": "https://pay.anyspend.com/s/cs_abc123",
          "status": "completed",
          "payment_link_id": "pl_abc123",
          "product_id": null,
          "token_address": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
          "chain_id": 1,
          "recipient_address": "0x1234567890abcdef1234567890abcdef12345678",
          "amount": "50000000",
          "amount_usd": "50.00",
          "success_url": "https://example.com/success?session_id=cs_abc123",
          "cancel_url": "https://example.com/cancel",
          "client_reference_id": "order_12345",
          "metadata": {
            "order_id": "12345"
          },
          "payer_address": "0xaabb1234ccdd5678eeff9900aabb1234ccdd5678",
          "tx_hash": "0x9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1f0e",
          "customer_id": "cust_abc123",
          "form_data": null,
          "shipping_address": null,
          "utm_source": "twitter",
          "utm_medium": "social",
          "utm_campaign": "launch_feb_2026",
          "expires_at": "2026-02-25T08:45:00Z",
          "created_at": "2026-02-25T08:15:00Z",
          "completed_at": "2026-02-25T08:16:30Z"
        }
      ],
      "pagination": {
        "page": 1,
        "limit": 20,
        "total": 340,
        "total_pages": 17,
        "has_more": true
      }
    }
    ```
  </Tab>
</Tabs>

---

## Membuat sesi checkout

Buat sesi checkout di sisi server dengan URL pembayaran unik. Gunakan ini untuk integrasi programatik di mana Anda mengontrol alur checkout dari backend Anda.

<ParamField body="payment_link_id" type="string">
  Buat sesi dari tautan pembayaran yang ada. Ini mewarisi konfigurasi tautan. Entah `payment_link_id` atau field manual (`token_address`, `chain_id`, `recipient_address`, `amount`) diperlukan.
</ParamField>

<ParamField body="token_address" type="string">
  Alamat kontrak dari token yang diterima. Diperlukan jika `payment_link_id` tidak disediakan.
</ParamField>

<ParamField body="chain_id" type="number">
  Chain ID tempat Anda ingin menerima pembayaran. Diperlukan jika `payment_link_id` tidak disediakan.
</ParamField>

<ParamField body="recipient_address" type="string">
  Alamat dompet yang menerima pembayaran. Diperlukan jika `payment_link_id` tidak disediakan.
</ParamField>

<ParamField body="amount" type="string">
  Jumlah pembayaran dalam unit terkecil token. Diperlukan jika `payment_link_id` tidak disediakan.
</ParamField>

<ParamField body="product_id" type="string">
  Asosiasikan sesi dengan produk.
</ParamField>

<ParamField body="success_url" type="string">
  URL untuk mengarahkan pelanggan setelah pembayaran berhasil. Mendukung variabel template `{SESSION_ID}`.
</ParamField>

<ParamField body="cancel_url" type="string">
  URL untuk mengarahkan pelanggan jika mereka membatalkan.
</ParamField>

<ParamField body="client_reference_id" type="string">
  ID referensi internal Anda (mis., ID pesanan). Maksimum 200 karakter.
</ParamField>

<ParamField body="metadata" type="object">
  Pasangan kunci-nilai sembarang yang dilewatkan ke webhook dan transaksi yang dihasilkan. Hingga 50 kunci, nilai karakter 500.
</ParamField>

<ParamField body="customer_email" type="string">
  Alamat email pelanggan. Di-enkripsi saat istirahat dan termasuk dalam payload webhook untuk pemenuhan pesanan.
</ParamField>

<ParamField body="customer_name" type="string">
  Nama pelanggan. Di-enkripsi saat istirahat dan termasuk dalam payload webhook untuk pemenuhan pesanan.
</ParamField>

<ParamField body="expires_in" type="number" default={1800}>
  Waktu kedaluwarsa sesi dalam detik. Minimum 300 (5 menit), maksimum 86400 (24 jam). Default: 1800 (30 menit).
</ParamField>

<ParamField body="utm_source" type="string">
  Sumber UTM untuk pelacakan atribusi.
</ParamField>

<ParamField body="utm_medium" type="string">
  Medium UTM untuk pelacakan atribusi.
</ParamField>

<ParamField body="utm_campaign" type="string">
  Kampanye UTM untuk pelacakan atribusi.
</ParamField>

<CodeGroup>
```bash cURL
# Buat dari tautan pembayaran
curl -X POST "https://platform-api.anyspend.com/api/v1/checkout-sessions" \
  -H "Authorization: Bearer asp_xxx" \
  -H "Content-Type: application/json" \
  -d '{
    "payment_link_id": "pl_abc123",
    "success_url": "https://example.com/success?session_id={SESSION_ID}",
    "cancel_url": "https://example.com/cancel",
    "client_reference_id": "order_12345",
    "metadata": {
      "order_id": "12345"
    },
    "customer_email": "alice@example.com",
    "customer_name": "Alice Smith",
    "expires_in": 3600
  }'

# Buat dengan konfigurasi manual
curl -X POST "https://platform-api.anyspend.com/api/v1/checkout-sessions" \
  -H "Authorization: Bearer asp_xxx" \
  -H "Content-Type: application/json" \
  -d '{
    "token_address": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
    "chain_id": 1,
    "recipient_address": "0x1234567890abcdef1234567890abcdef12345678",
    "amount": "25000000",
    "success_url": "https://example.com/success?session_id={SESSION_ID}",
    "cancel_url": "https://example.com/cancel",
    "client_reference_id": "inv_67890",
    "utm_source": "email",
    "utm_medium": "newsletter",
    "utm_campaign": "february_promo"
  }'
```

```typescript SDK
// Buat dari tautan pembayaran
const session = await anyspend.checkoutSessions.create({
  paymentLinkId: "pl_abc123",
  successUrl: "https://example.com/success?session_id={SESSION_ID}",
  cancelUrl: "https://example.com/cancel",
  clientReferenceId: "order_12345",
  metadata: {
    order_id: "12345",
    user_email: "alice@example.com",
  },
  expiresIn: 3600,
});

// Arahkan pelanggan untuk membayar
console.log(session.url);
// => "https://pay.anyspend.com/s/cs_newSession123"

// Buat dengan konfigurasi manual
const manualSession = await anyspend.checkoutSessions.create({
  tokenAddress: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
  chainId: 1,
  recipientAddress: "0x1234567890abcdef1234567890abcdef12345678",
  amount: "25000000",
  successUrl: "https://example.com/success?session_id={SESSION_ID}",
  cancelUrl: "https://example.com/cancel",
  clientReferenceId: "inv_67890",
});
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    ```json
    {
      "id": "cs_newSession123",
      "url": "https://pay.anyspend.com/s/cs_newSession123",
      "status": "open",
      "payment_link_id": "pl_abc123",
      "product_id": null,
      "token_address": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
      "chain_id": 1,
      "recipient_address": "0x1234567890abcdef1234567890abcdef12345678",
      "amount": "50000000",
      "amount_usd": "50.00",
      "success_url": "https://example.com/success?session_id={SESSION_ID}",
      "cancel_url": "https://example.com/cancel",
      "client_reference_id": "order_12345",
      "metadata": {
        "order_id": "12345",
        "user_email": "alice@example.com"
      },
      "payer_address": null,
      "tx_hash": null,
      "customer_id": null,
      "form_data": null,
      "shipping_address": null,
      "utm_source": null,
      "utm_medium": null,
      "utm_campaign": null,
      "expires_at": "2026-02-27T11:30:00Z",
      "created_at": "2026-02-27T10:30:00Z",
      "completed_at": null
    }
    ```
  </Tab>
</Tabs>

---

## Mengambil sesi checkout

<ParamField path="id" type="string" required>
  ID sesi checkout (mis., `cs_abc123`).
</ParamField>

<Tip>
  Gunakan endpoint ini dalam handler `success_url` Anda untuk memverifikasi status pembayaran dan mengambil detail transaksi setelah pelanggan diarahkan kembali ke situs Anda.
</Tip>

<CodeGroup>
```bash cURL
curl -X GET "https://platform-api.anyspend.com/api/v1/checkout-sessions/cs_abc123" \
  -H "Authorization: Bearer asp_xxx"
```

```typescript SDK
const session = await anyspend.checkoutSessions.retrieve("cs_abc123");

if (session.status === "completed") {
  // Pembayaran berhasil
  console.log("Hash transaksi:", session.tx_hash);
  console.log("Pembayar:", session.payer_address);
}
```
</CodeGroup>

<Tabs>
  <Tab title="Response">
    Mengembalikan objek [Checkout Session](#the-checkout-session-object) lengkap.
  </Tab>
</Tabs>

---

## Mengakhiri sesi checkout

Secara manual mengakhiri sesi checkout yang terbuka. Ini berguna ketika pesanan yang mendasarinya dibatalkan atau pembayaran tidak lagi diperlukan.

<ParamField path="id" type="string" required>
  ID sesi checkout.
</ParamField>

<Warning>
  Hanya sesi dengan `status: "open"` yang dapat diakhiri. Mencoba mengakhiri sesi dalam status lain akan mengembalikan kesalahan `400 Bad Request`.
</Warning>

<CodeGroup>
```bash cURL
curl -X POST "https://platform-api.anyspend.com/api/v1/checkout-sessions/cs_abc123/expire" \
  -H "Authorization: Bearer
