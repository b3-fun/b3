---
title: React Hooks
description: B3 Global Accounts React hooks å®Œæ•´å‚è€ƒèµ„æ–™
lang: cn
originalPath: sdk/global-account/hooks.mdx
---
## è®¤è¯é’©å­

### useB3

ç”¨äºè®¿é—®å…¨å±€è´¦æˆ·è®¤è¯çŠ¶æ€å’Œæ“ä½œçš„ä¸»è¦é’©å­ã€‚

```tsx
import { useB3 } from "@b3dotfun/sdk/global-account/react";

function AuthComponent() {
  const { 
    account,           // å½“å‰å…¨å±€è´¦æˆ·
    isAuthenticated,   // è®¤è¯çŠ¶æ€
    isLoading,         // åŠ è½½çŠ¶æ€
    signOut,           // ç™»å‡ºå‡½æ•°
    refreshAccount     // åˆ·æ–°è´¦æˆ·æ•°æ®
  } = useB3();

  return (
    <div>
      {isLoading && <p>Loading...</p>}
      
      {isAuthenticated ? (
        <div>
          <h3>Welcome, {account?.displayName}!</h3>
          <p>Account ID: {account?.id}</p>
          <p>Email: {account?.email}</p>
          <button onClick={signOut}>Sign Out</button>
        </div>
      ) : (
        <p>Please sign in to continue</p>
      )}
    </div>
  );
}
```

#### è¿”å›å€¼

| å±æ€§ | ç±»å‹ | æè¿° |
|----------|------|-------------|
| `account` | `GlobalAccount \| null` | å½“å‰è®¤è¯çš„è´¦æˆ· |
| `isAuthenticated` | `boolean` | ç”¨æˆ·æ˜¯å¦å·²è®¤è¯ |
| `isLoading` | `boolean` | æ˜¯å¦æ­£åœ¨è¿›è¡Œè®¤è¯æ£€æŸ¥ |
| `signOut` | `() => Promise<void>` | ç™»å‡ºå½“å‰ç”¨æˆ·çš„å‡½æ•° |
| `refreshAccount` | `() => Promise<void>` | åˆ·æ–°è´¦æˆ·æ•°æ®çš„å‡½æ•° |

### useAccountWallet

è®¿é—®å·²è®¤è¯è´¦æˆ·çš„é’±åŒ…ä¿¡æ¯ã€‚

```tsx
import { useAccountWallet } from "@b3dotfun/sdk/global-account/react";

function WalletComponent() {
  const { 
    wallet,       // é’±åŒ…ä¿¡æ¯
    isConnected,  // è¿æ¥çŠ¶æ€
    connect,      // è¿æ¥é’±åŒ…å‡½æ•°
    disconnect    // æ–­å¼€é’±åŒ…è¿æ¥å‡½æ•°
  } = useAccountWallet();

  return (
    <div>
      {isConnected ? (
        <div>
          <p>Address: {wallet?.address}</p>
          <p>Chain: {wallet?.chainId}</p>
          <p>Balance: {wallet?.balance} ETH</p>
          <button onClick={disconnect}>Disconnect</button>
        </div>
      ) : (
        <button onClick={connect}>Connect Wallet</button>
      )}
    </div>
  );
}
```

## æƒé™é’©å­

### usePermissions

ç®¡ç†å’Œæ£€æŸ¥ä¼šè¯å¯†é’¥æƒé™ã€‚

```tsx
import { usePermissions } from "@b3dotfun/sdk/global-account/react";

function PermissionsComponent() {
  const { 
    permissions,      // å½“å‰æƒé™
    hasPermissions,   // ç”¨æˆ·æ˜¯å¦æœ‰æ´»åŠ¨æƒé™
    isExpired,        // æƒé™æ˜¯å¦å·²è¿‡æœŸ
    checkPermission   // æ£€æŸ¥ç‰¹å®šæƒé™
  } = usePermissions();

  const canInteractWithContract = checkPermission("0x...");

  return (
    <div>
      <h3>Permission Status</h3>
      
      {hasPermissions ? (
        <div>
          <p>âœ… Active Permissions</p>
          <p>Expires: {permissions?.endDate.toLocaleDateString()}</p>
          <p>Contracts: {permissions?.approvedTargets.length}</p>
          
          {isExpired && <p>âš ï¸ Permissions expired</p>}
          
          <div>
            <p>Can interact with contract: {canInteractWithContract ? 'âœ…' : 'âŒ'}</p>
          </div>
        </div>
      ) : (
        <p>No active permissions</p>
      )}
    </div>
  );
}
```

### useRequestPermissions

ä¸ºä¼šè¯å¯†é’¥è¯·æ±‚æ–°æƒé™ã€‚

```tsx
import { useRequestPermissions } from "@b3dotfun/sdk/global-account/react";

function RequestPermissionsComponent() {
  const { 
    requestPermissions, 
    isLoading, 
    error,
    reset 
  } = useRequestPermissions();

  const handleRequest = async () => {
    try {
      const result = await requestPermissions({
        chain: { id: 8333, name: "B3" },
        sessionKeyAddress: "0x...",
        permissions: {
          approvedTargets: ["0x..."],
          startDate: new Date(),
          endDate: new Date(Date.now() + 24 * 60 * 60 * 1000),
          nativeTokenLimitPerTransaction: 0.01,
        },
      });

      if (result.success) {
        console.log("Permissions granted!");
      }
    } catch (err) {
      console.error("Permission request failed:", err);
    }
  };

  return (
    <div>
      <button 
        onClick={handleRequest}
        disabled={isLoading}
      >
        {isLoading ? "Requesting..." : "Request Permissions"}
      </button>
      
      {error && (
        <div className="error">
          Error: {error.message}
          <button onClick={reset}>Retry</button>
        </div>
      )}
    </div>
  );
}
```

### useRevokePermissions

æ’¤é”€ç°æœ‰æƒé™ã€‚

```tsx
import { useRevokePermissions } from "@b3dotfun/sdk/global-account/react";

function RevokePermissionsComponent() {
  const { revokePermissions, isLoading, error } = useRevokePermissions();

  const handleRevoke = async () => {
    try {
      await revokePermissions({
        sessionKeyAddress: "0x...",
        chain: { id: 8333, name: "B3" },
      });
      console.log("Permissions revoked successfully");
    } catch (err) {
      console.error("Failed to revoke permissions:", err);
    }
  };

  return (
    <button 
      onClick={handleRevoke}
      disabled={isLoading}
    >
      {isLoading ? "Revoking..." : "Revoke Permissions"}
    </button>
  );
}
```

## èµ„äº§ç®¡ç†é’©å­

### useAccountAssets

æ£€ç´¢å’Œç®¡ç†ç”¨æˆ·çš„æ•°å­—èµ„äº§ã€‚

```tsx
import { useAccountAssets } from "@b3dotfun/sdk/global-account/react";

function AssetsComponent() {
  const { 
    assets,        // ç”¨æˆ·çš„èµ„äº§
    isLoading,     // åŠ è½½çŠ¶æ€
    error,         // é”™è¯¯çŠ¶æ€
    refreshAssets  // åˆ·æ–°èµ„äº§å‡½æ•°
  } = useAccountAssets();

  if (isLoading) return <div>Loading assets...</div>;
  if (error) return <div>Error loading assets: {error.message}</div>;

  return (
    <div>
      <h3>Your Assets</h3>
      <button onClick={refreshAssets}>Refresh</button>
      
      {assets?.map((asset) => (
        <div key={asset.id} className="asset-item">
          <img src={asset.imageUrl} alt={asset.name} />
          <h4>{asset.name}</h4>
          <p>{asset.description}</p>
          <p>Value: {asset.value} {asset.currency}</p>
        </div>
      ))}
    </div>
  );
}
```

## æ¨¡æ€ç®¡ç†é’©å­

### useModal

ä»¥ç¼–ç¨‹æ–¹å¼æ§åˆ¶ B3 æ¨¡æ€ã€‚

```tsx
import { useModal } from "@b3dotfun/sdk/global-account/react";

function ModalControlComponent() {
  const { 
    openModal, 
    closeModal, 
    isModalOpen,
    currentModal 
  } = useModal();

  const handleOpenAuth = () => {
    openModal('authentication', {
      provider: { strategy: 'google' },
      partnerId: 'your-partner-id'
    });
  };

  const handleOpenPermissions = () => {
    openModal('permissions', {
      sessionKeyAddress: '0x...',
      permissions: {
        approvedTargets: ['0x...'],
        nativeTokenLimitPerTransaction: 0.01
      }
    });
  };

  return (
    <div>
      <p>Current modal: {currentModal || 'None'}</p>
      <p>Modal open: {isModalOpen ? 'Yes' : 'No'}</p>
      
      <button onClick={handleOpenAuth}>Open Auth Modal</button>
      <button onClick={handleOpenPermissions}>Open Permissions Modal</button>
      <button onClick={closeModal}>Close Modal</button>
    </div>
  );
}
```

## å¯¼èˆªé’©å­

### useNavigation

å¤„ç† B3 åº”ç”¨å†…çš„å¯¼èˆªã€‚

```tsx
import { useNavigation } from "@b3dotfun/sdk/global-account/react";

function NavigationComponent() {
  const { 
    navigate, 
    canGoBack, 
    goBack,
    currentPath 
  } = useNavigation();

  return (
    <div>
      <p>Current path: {currentPath}</p>
      
      <button onClick={() => navigate('/dashboard')}>
        Go to Dashboard
      </button>
      
      <button onClick={() => navigate('/profile')}>
        Go to Profile
      </button>
      
      {canGoBack && (
        <button onClick={goBack}>
          Go Back
        </button>
      )}
    </div>
  );
}
```

## é…ç½®é’©å­

### useB3Config

è®¿é—® B3 é…ç½®å’Œç¯å¢ƒè®¾ç½®ã€‚

```tsx
import { useB3Config } from "@b3dotfun/sdk/global-account/react";

function ConfigComponent() {
  const { 
    environment,     // 'production' | 'development'
    apiUrl,          // å½“å‰ API URL
    partnerId,       // æ‚¨çš„åˆä½œä¼™ä¼´ ID
    features,        // å¯ç”¨åŠŸèƒ½
    updateConfig     // æ›´æ–°é…ç½®
  } = useB3Config();

  return (
    <div>
      <h3>B3 Configuration</h3>
      <p>Environment: {environment}</p>
      <p>API URL: {apiUrl}</p>
      <p>Partner ID: {partnerId}</p>
      
      <h4>Available Features:</h4>
      <ul>
        {features.map(feature => (
          <li key={feature}>{feature}</li>
        ))}
      </ul>
    </div>
  );
}
```

## é’©å­ç»„åˆ

### è‡ªå®šä¹‰é’©å­ç¤ºä¾‹

ç»“åˆå¤šä¸ªé’©å­å®ç°å¤æ‚åŠŸèƒ½ï¼š

```tsx
import { useB3, usePermissions, useAccountWallet } from "@b3dotfun/sdk/global-account/react";

function useGameAuth() {
  const { account, isAuthenticated } = useB3();
  const { hasPermissions, isExpired } = usePermissions();
  const { wallet, isConnected } = useAccountWallet();

  const isGameReady = isAuthenticated && hasPermissions && !isExpired && isConnected;
  
  const gameAuthStatus = {
    account: !!account,
    permissions: hasPermissions && !isExpired,
    wallet: isConnected,
    ready: isGameReady
  };

  return {
    account,
    wallet,
    isGameReady,
    gameAuthStatus
  };
}

// ä½¿ç”¨
function GameComponent() {
  const { isGameReady, gameAuthStatus } = useGameAuth();

  if (!isGameReady) {
    return (
      <div>
        <h3>Setup Required</h3>
        <ul>
          <li>Account: {gameAuthStatus.account ? 'âœ…' : 'âŒ'}</li>
          <li>Permissions: {gameAuthStatus.permissions ? 'âœ…' : 'âŒ'}</li>
          <li>Wallet: {gameAuthStatus.wallet ? 'âœ…' : 'âŒ'}</li>
        </ul>
      </div>
    );
  }

  return <div>ğŸ® Game Ready!</div>;
}
```

## TypeScript æ”¯æŒ

æ‰€æœ‰é’©å­éƒ½å®Œå…¨æ”¯æŒ TypeScriptï¼š

```typescript
import type { 
  GlobalAccount, 
  Permissions, 
  WalletInfo 
} from "@b3dotfun/sdk/global-account/types";

// é’©å­è¿”å›ç±»å‹å®Œå…¨ç±»å‹åŒ–
const { account }: { account: GlobalAccount | null } = useB3();
const { permissions }: { permissions: Permissions | null } = usePermissions();
const { wallet }: { wallet: WalletInfo | null } = useAccountWallet();
```

## é”™è¯¯å¤„ç†

ä½¿ç”¨é’©å­å¤„ç†é”™è¯¯çš„æœ€ä½³å®è·µï¼š

```tsx
function ErrorHandlingExample() {
  const { account, isAuthenticated } = useB3();
  const { requestPermissions, error: permissionError } = useRequestPermissions();
  const { assets, error: assetError } = useAccountAssets();

  // å¤„ç†ç‰¹å®šé”™è¯¯
  useEffect(() => {
    if (permissionError) {
      console.error('Permission error:', permissionError);
      // æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
    }
    
    if (assetError) {
      console.error('Asset loading error:', assetError);
      // é‡è¯•æˆ–æ˜¾ç¤ºå¤‡ç”¨ UI
    }
  }, [permissionError, assetError]);

  return (
    <div>
      {/* æ‚¨çš„ç»„ä»¶ JSX */}
    </div>
  );
}
```

## ä¸‹ä¸€æ­¥

<CardGroup cols={2}>

<Card title="ç¤ºä¾‹" icon="code" href="/sdk/global-account/examples">
  æŸ¥çœ‹ä½¿ç”¨è¿™äº›é’©å­çš„å®Œæ•´ç¤ºä¾‹ã€‚
</Card>

</CardGroup>
