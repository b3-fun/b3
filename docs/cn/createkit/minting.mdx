---
title: é“¸å¸
description: ä½¿ç”¨ CreateKit è¿›è¡Œä»£å¸é“¸é€ çš„å®Œæ•´æŒ‡å—ï¼ŒåŒ…æ‹¬éƒ¨ç½²ã€å¸¸è§„é“¸é€ å’Œé«˜çº§åŠŸèƒ½
lang: cn
originalPath: createkit/minting.mdx
---
## æ¦‚è§ˆ

é“¸é€ æ˜¯åœ¨æ‚¨çš„æ”¶è—ä¸­åˆ›å»ºæ–° NFT ä»£å¸çš„è¿‡ç¨‹ã€‚CreateKit æä¾›äº†ä¸€ä¸ªç‹¬ç‰¹çš„ä¸¤é˜¶æ®µé“¸é€ ç³»ç»Ÿï¼Œä¼˜åŒ–äº†ç‡ƒæ°”æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

## é“¸é€ é˜¶æ®µ

### é˜¶æ®µ 1ï¼šéƒ¨ç½²å’Œé¦–æ¬¡é“¸é€ 

é¦–æ¬¡é“¸é€ æ“ä½œæ˜¯ç‰¹æ®Šçš„ - å®ƒåœ¨å•ä¸ªäº¤æ˜“ä¸­éƒ¨ç½²é›†åˆåˆçº¦å¹¶é“¸é€ ç¬¬ä¸€ä¸ªä»£å¸ï¼š

```typescript title="éƒ¨ç½²å’Œé¦–æ¬¡é“¸é€ "
import { CollectionManager } from '@b3dotfun/basemint'

const collectionManager = new CollectionManager(publicClient)

// å‡è®¾æˆ‘ä»¬æœ‰æ”¶è—å…ƒæ•°æ®å’Œåˆ›å»ºè€…ç­¾å
const predictedAddress = collectionManager.predictCollectionAddress(
  collectionMetadata,
  creatorSignature
)

// ç”Ÿæˆéƒ¨ç½²è€…ç­¾å
const deployerSignature = await collectionManager.generateDeployerSignature(
  walletClient,
  predictedAddress
)

// åˆ›å»ºé›†åˆå®ä¾‹
const collection = collectionManager.createCollection(
  predictedAddress,
  collectionMetadata.tokenStandard
)

// éƒ¨ç½²å¹¶é“¸é€ é¦–ä¸ª NFT
const mintTx = await collection.mint(
  walletClient,
  1n, // æ•°é‡
  undefined, // å…ƒæ•°æ® URIï¼ˆä½¿ç”¨ baseURIï¼‰
  collectionMetadata.mintPrice || 0n,
  [], // ç™½åå•è¯æ˜ï¼ˆå…¬å¼€ä¸ºç©ºï¼‰
  creatorSignature, // é¦–æ¬¡é“¸é€ æ‰€éœ€
  deployerSignature // é¦–æ¬¡é“¸é€ æ‰€éœ€
)

console.log(`ğŸš€ é›†åˆéƒ¨ç½²å¹¶é¦–ä¸ªä»£å¸é“¸é€ å®Œæˆï¼š${mintTx}`)
```

### é˜¶æ®µ 2ï¼šå¸¸è§„é“¸é€ 

éƒ¨ç½²åï¼Œåç»­çš„é“¸é€ æ›´ç®€å•ï¼Œåªéœ€è¦æ ‡å‡†å‚æ•°ï¼š

```typescript title="å¸¸è§„é“¸é€ "
// å¯¹äºéƒ¨ç½²åçš„åç»­é“¸é€ 
const regularMintTx = await collection.mint(
  walletClient,
  1n, // æ•°é‡
  undefined, // å…ƒæ•°æ® URI
  collectionMetadata.mintPrice || 0n,
  [] // ç™½åå•è¯æ˜
  // å¸¸è§„é“¸é€ ä¸éœ€è¦ç­¾å
)

console.log(`âœ¨ ä»£å¸é“¸é€ å®Œæˆï¼š${regularMintTx}`)
```

## ä»£å¸æ ‡å‡†

CreateKit æ”¯æŒ ERC721 å’Œ ERC1155 æ ‡å‡†ï¼Œå…·æœ‰ä¸åŒçš„é“¸é€ è¡Œä¸ºï¼š

<Tabs>
<Tab title="ERC721 é“¸é€ ">
```typescript title="ERC721 ç‹¬ç‰¹ä»£å¸"
// ERC721 - æ¯ä¸ªä»£å¸éƒ½æ˜¯ç‹¬ç‰¹çš„
const erc721Collection = collectionManager.createCollection(
  predictedAddress,
  "ERC721"
)

// ERC721 æ€»æ˜¯é“¸é€ æ•°é‡ä¸º 1
await erc721Collection.mint(
  walletClient,
  1n, // å¯¹äº ERC721 æ€»æ˜¯ 1
  "https://example.com/metadata/1.json", // æ­¤ä»£å¸çš„ç‹¬ç‰¹å…ƒæ•°æ®
  parseEther("0.01"),
  []
)

// æ¯æ¬¡é“¸é€ éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç‹¬ç‰¹ä»£å¸ ID
// ä»£å¸ ID é€’å¢ï¼š1, 2, 3, ç­‰ã€‚
```
</Tab>

<Tab title="ERC1155 é“¸é€ ">
```typescript title="ERC1155 åŠåŒè´¨åŒ–ä»£å¸"
// ERC1155 - å¯ä»¥é“¸é€ ç›¸åŒæˆ–ä¸åŒçš„å¤šä¸ªä»£å¸
const erc1155Collection = collectionManager.createCollection(
  predictedAddress,
  "ERC1155"
)

// å¯ä»¥é“¸é€ ç›¸åŒç±»å‹çš„å¤šä¸ªä»£å¸
await erc1155Collection.mint(
  walletClient,
  10n, // é“¸é€  10 ä¸ªä»£å¸
  "https://example.com/metadata/sword.json", // â€œå‰‘â€ä»£å¸çš„å…ƒæ•°æ®
  parseEther("0.005"),
  []
)

// é€šè¿‡æ›´æ”¹å…ƒæ•°æ® URI é“¸é€ ä¸åŒç±»å‹çš„ä»£å¸
await erc1155Collection.mint(
  walletClient,
  5n,
  "https://example.com/metadata/shield.json", // ä¸åŒç±»å‹çš„ä»£å¸
  parseEther("0.01"),
  []
)
```
</Tab>
</Tabs>

## å®šä»·å’Œæ”¯ä»˜

### å›ºå®šå®šä»·

```typescript title="å›ºå®šä»·æ ¼é“¸é€ "
import { parseEther } from 'viem'

const fixedPriceCollection = {
  name: "å›ºå®šä»·æ ¼é›†åˆ",
  symbol: "FPC",
  creator: account.address,
  gameOwner: account.address,
  mintPrice: parseEther("0.01"), // æ¯ä¸ªä»£å¸ 0.01 ETH
  maxPerWallet: 5n
}

// ä»¥å›ºå®šä»·æ ¼é“¸é€ 
await collection.mint(
  walletClient,
  2n, // æ•°é‡
  undefined,
  parseEther("0.02"), // 2 * 0.01 ETH
  []
)
```

### å…è´¹é“¸é€ 

```typescript title="å…è´¹é“¸é€ "
const freeCollection = {
  name: "å…è´¹é›†åˆ",
  symbol: "FREE",
  creator: account.address,
  gameOwner: account.address,
  mintPrice: 0n, // å…è´¹é“¸é€ 
  maxPerWallet: 10n
}

// å…è´¹é“¸é€ ï¼ˆåªéœ€æ”¯ä»˜ç‡ƒæ°”è´¹ï¼‰
await collection.mint(
  walletClient,
  1n,
  undefined,
  0n, // æ— éœ€æ”¯ä»˜
  []
)
```

### åŠ¨æ€å®šä»·

```typescript title="åŠ¨æ€å®šä»·é€»è¾‘"
// åœ¨æ‚¨çš„åº”ç”¨ç¨‹åºä¸­è‡ªå®šä¹‰å®šä»·é€»è¾‘
function calculateMintPrice(totalSupply: bigint, basePrice: bigint): bigint {
  // ä»·æ ¼éšä¾›åº”é‡å¢åŠ 
  const priceMultiplier = totalSupply / 1000n + 1n
  return basePrice * priceMultiplier
}

// è·å–å½“å‰ä¾›åº”é‡å¹¶è®¡ç®—ä»·æ ¼
const currentSupply = await collection.totalSupply()
const dynamicPrice = calculateMintPrice(currentSupply, parseEther("0.001"))

await collection.mint(
  walletClient,
  1n,
  undefined,
  dynamicPrice,
  []
)
```

## ç™½åå•é“¸é€ 

CreateKit æ”¯æŒåŸºäº Merkle æ ‘çš„ç™½åå•ï¼Œç”¨äºç‹¬å®¶é“¸é€ ï¼š

### è®¾ç½®ç™½åå•

```typescript title="ç™½åå•è®¾ç½®"
import { WhitelistManager } from '@b3dotfun/basemint'

// ä½¿ç”¨åœ°å€åˆ›å»ºç™½åå•
const whitelist = new WhitelistManager([
  { address: "0x1234567890123456789012345678901234567890" },
  { address: "0x2345678901234567890123456789012345678901" },
  { address: "0x3456789012345678901234567890123456789012" }
])

// è·å–é›†åˆéƒ¨ç½²çš„ Merkle æ ¹
const merkleRoot = whitelist.getRoot()

const whitelistCollection = {
  name: "ç™½åå•é›†åˆ",
  symbol: "WLC",
  creator: account.address,
  gameOwner: account.address,
  isWhitelistEnabled: true,
  whitelistMerkleRoot: merkleRoot,
  mintPrice: parseEther("0.005")
}
```

### ç™½åå•é“¸é€ 

```typescript title="ä½¿ç”¨ç™½åå•è¯æ˜é“¸é€ "
// è·å–é“¸é€ åœ°å€çš„è¯æ˜
const userAddress = account.address
const proof = whitelist.getProof(userAddress)

// éªŒè¯ç”¨æˆ·æ˜¯å¦åœ¨ç™½åå•ä¸­ï¼ˆå¯é€‰æ£€æŸ¥ï¼‰
const isWhitelisted = whitelist.verify(userAddress, proof)
if (!isWhitelisted) {
  throw new Error("åœ°å€ä¸åœ¨ç™½åå•ä¸­")
}

// ä½¿ç”¨ç™½åå•è¯æ˜é“¸é€ 
await collection.mint(
  walletClient,
  1n,
  undefined,
  parseEther("0.005"),
  proof // æä¾›ç™½åå•è¯æ˜
)
```

## é“¸é€ é™åˆ¶å’Œæ§åˆ¶

### æ¯ä¸ªé’±åŒ…çš„é™åˆ¶

```typescript title="é’±åŒ…é™åˆ¶"
// è®¾ç½®æ¯ä¸ªé’±åŒ…çš„æœ€å¤§ä»£å¸æ•°é‡
const limitedCollection = {
  name: "é™é‡é›†åˆ",
  symbol: "LTD",
  creator: account.address,
  gameOwner: account.address,
  maxPerWallet: 3n, // æ¯ä¸ªé’±åŒ…æœ€å¤š 3 ä¸ªä»£å¸
  maxSupply: 1000n
}

// é“¸é€ å‰æ£€æŸ¥å½“å‰ä½™é¢
const currentBalance = await collection.balanceOf(account.address)
const maxPerWallet = await collection.maxPerWallet()

if (currentBalance >= maxPerWallet) {
  throw new Error("é’±åŒ…é™é¢å·²è¶…")
}

await collection.mint(walletClient, 1n, undefined, 0n, [])
```

### åŸºäºæ—¶é—´çš„æ§åˆ¶

```typescript title="æ—¶é—´æ§åˆ¶"
const timedCollection = {
  name: "å®šæ—¶å‘å¸ƒ",
  symbol: "TIME",
  creator: account.address,
  gameOwner: account.address,
  startTime: BigInt(Math.floor(Date.now() / 1000) + 3600), // 1 å°æ—¶åå¼€å§‹
  endTime: BigInt(Math.floor(Date.now() / 1000) + 86400), // 24 å°æ—¶åç»“æŸ
}

// æ£€æŸ¥é“¸é€ æ˜¯å¦å½“å‰æ´»è·ƒ
const currentTime = BigInt(Math.floor(Date.now() / 1000))
const startTime = await collection.startTime()
const endTime = await collection.endTime()

const isMintingActive = currentTime >= startTime && currentTime <= endTime

if (!isMintingActive) {
  throw new Error("å½“å‰æœªæ¿€æ´»é“¸é€ ")
}
```

## å…ƒæ•°æ®å¤„ç†

### è‡ªåŠ¨å…ƒæ•°æ®

CreateKit å¯ä»¥æ ¹æ®é›†åˆè®¾ç½®è‡ªåŠ¨ç”Ÿæˆå…ƒæ•°æ®ï¼š

```typescript title="è‡ªåŠ¨ç”Ÿæˆçš„å…ƒæ•°æ®"
// ä½¿ç”¨ baseURI è‡ªåŠ¨ç”Ÿæˆå…ƒæ•°æ®
const autoMetadataCollection = {
  name: "è‡ªåŠ¨å…ƒæ•°æ®é›†åˆ",
  symbol: "AMC",
  creator: account.address,
  gameOwner: account.address,
  // baseURI å°†ç”± BaseMint CDN è‡ªåŠ¨ç”Ÿæˆ
}

// ä½¿ç”¨è‡ªåŠ¨å…ƒæ•°æ®é“¸é€ ï¼ˆå¯¹ URI ä¼ é€’ undefinedï¼‰
await collection.mint(
  walletClient,
  1n,
  undefined, // ä½¿ç”¨ baseURI + tokenId
  0n,
  []
)

// å…ƒæ•°æ®å°†åœ¨ï¼š{baseURI}/{tokenId} å¤„å¯ç”¨
```

### è‡ªå®šä¹‰å…ƒæ•°æ®

```typescript title="è‡ªå®šä¹‰å…ƒæ•°æ® URIs"
// ä¸ºæ¯ä¸ªä»£å¸æä¾›ç‰¹å®šçš„å…ƒæ•°æ® URI
const customMetadataURIs = [
  "https://myapi.com/metadata/special-sword.json",
  "https://myapi.com/metadata/rare-shield.json",
  "https://myapi.com/metadata/epic-helmet.json"
]

for (const metadataURI of customMetadataURIs) {
  await collection.mint(
    walletClient,
    1n,
    metadataURI, // æ­¤ä»£å¸çš„è‡ªå®šä¹‰å…ƒæ•°æ®
    parseEther("0.01"),
    []
  )
}
```

## æ‰¹é‡é“¸é€ 

å¯¹äº ERC1155 é›†åˆï¼Œæ‚¨å¯ä»¥é«˜æ•ˆåœ°é“¸é€ å¤šä¸ªä»£å¸ï¼š

```typescript title="æ‰¹é‡é“¸é€ "
// å•ä¸ªäº¤æ˜“ï¼Œå¤šä¸ªä»£å¸
await erc1155Collection.mint(
  walletClient,
  10n, // é“¸é€ ç›¸åŒç±»å‹çš„ 10 ä¸ªä»£å¸
  "https://example.com/metadata/resource.json",
  parseEther("0.001") * 10n, // æ‰€æœ‰ä»£å¸çš„æ€»ä»·æ ¼
  []
)

// å¯¹äºä¸åŒç±»å‹çš„ä»£å¸ï¼Œä½¿ç”¨å•ç‹¬çš„äº¤æ˜“
const tokenTypes = [
  { uri: "https://example.com/wood.json", quantity: 5n },
  { uri: "https://example.com/stone.json", quantity: 3n },
  { uri: "https://example.com/gold.json", quantity: 1n }
]

for (const tokenType of tokenTypes) {
  await erc1155Collection.mint(
    walletClient,
    tokenType.quantity,
    tokenType.uri,
    calculatePrice(tokenType.quantity),
    []
  )
}
```

## é”™è¯¯å¤„ç†

```typescript title="å…¨é¢çš„é”™è¯¯å¤„ç†"
async function safeMint(
  collection: any,
  walletClient: any,
  quantity: bigint,
  metadataURI: string | undefined,
  mintPrice: bigint,
  proof: string[]
) {
  try {
    // é“¸é€ å‰éªŒè¯
    const isDeployed = await collection.isDeployed()
    if (!isDeployed) {
      throw new Error("é›†åˆå°šæœªéƒ¨ç½²")
    }

    const currentSupply = await collection.totalSupply()
    const maxSupply = await collection.maxSupply()
    if (currentSupply + quantity > maxSupply) {
      throw new Error("å°†è¶…å‡ºæœ€å¤§ä¾›åº”é‡")
    }

    const userBalance = await collection.balanceOf(walletClient.account.address)
    const maxPerWallet = await collection.maxPerWallet()
    if (userBalance + quantity > maxPerWallet) {
      throw new Error("å°†è¶…å‡ºé’±åŒ…é™é¢")
    }

    // æ£€æŸ¥æ”¯ä»˜é‡‘é¢
    const requiredPayment = await collection.mintPrice() * quantity
    if (mintPrice < requiredPayment) {
      throw new Error("æ”¯ä»˜ä¸è¶³")
    }

    // å°è¯•é“¸é€ 
    const tx = await collection.mint(
      walletClient,
      quantity,
      metadataURI,
      mintPrice,
      proof
    )

    console.log(`âœ… é“¸é€ æˆåŠŸï¼š${tx}`)
    return tx

  } catch (error: any) {
    if (error.message.includes('Invalid merkle proof')) {
      console.error('âŒ åœ°å€ä¸åœ¨ç™½åå•ä¸­')
    } else if (error.message.includes('Insufficient payment')) {
      console.error('âŒ é“¸é€ ä»·æ ¼é”™è¯¯')
    } else if (error.message.includes('Max per wallet exceeded')) {
      console.error('âŒ é’±åŒ…é™é¢å·²è¾¾')
    } else {
      console.error('âŒ é“¸é€ å¤±è´¥ï¼š', error.message)
    }
    throw error
  }
}
```

## ç‡ƒæ°”ä¼˜åŒ–

### é«˜æ•ˆé“¸é€ æ¨¡å¼

```typescript title="ç‡ƒæ°”æ•ˆç‡é«˜çš„é“¸é€ "
// å¯¹äº ERC1155ï¼šåœ¨ä¸€ä¸ªäº¤æ˜“ä¸­é“¸é€ å¤šä¸ªä»£å¸
await erc1155Collection.mint(
  walletClient,
  10n, // æ¯” 10 ä¸ªå•ç‹¬çš„äº¤æ˜“æ›´èŠ‚çœç‡ƒæ°”
  metadataURI,
  totalPrice,
  proof
)

// å¯¹äº ERC721ï¼šè€ƒè™‘åœ¨åº”ç”¨ç¨‹åºçº§åˆ«è¿›è¡Œæ‰¹é‡æ“ä½œ
const mintPromises = []
for (let i = 0; i < 5; i++) {
  mintPromises.push(
    collection.mint(walletClient, 1n, undefined, mintPrice, proof)
  )
}

// å¹¶å‘æ‰§è¡Œé“¸é€ ï¼ˆæ³¨æ„ç®¡ç† nonceï¼‰
const results = await Promise.all(mintPromises)
```

### ç‡ƒæ°”ä»·æ ¼ç®¡ç†

```typescript title="ç‡ƒæ°”ä»·æ ¼ä¼˜åŒ–"
import { createWalletClient, http } from 'viem'

// è‡ªå®šä¹‰ç‡ƒæ°”é…ç½®
const optimizedWalletClient = createWalletClient({
  chain: b3Testnet,
  transport: http(),
  account,
  // ç‡ƒæ°”é…ç½®
  gasPrice: parseGwei('20'), // è‡ªå®šä¹‰ç‡ƒæ°”ä»·æ ¼
})

// æˆ–ä½¿ç”¨åŠ¨æ€ç‡ƒæ°”å®šä»·
const gasPrice = await publicClient.getGasPrice()
const adjustedGasPrice = gasPrice * 110n / 100n // å½“å‰ä»·æ ¼ä¸Š 10%

await collection.mint(
  optimizedWalletClient,
  1n,
  undefined,
  mintPrice,
  proof,
  {
    gasPrice: adjustedGasPrice
  }
)
```

## ç›‘æ§å’Œåˆ†æ

### é“¸é€ äº‹ä»¶è·Ÿè¸ª

```typescript title="äº‹ä»¶ç›‘æ§"
import { getCollectionMintEvents } from '@b3dotfun/basemint'

// è·Ÿè¸ªé“¸é€ äº‹ä»¶
const fromBlock = await publicClient.getBlockNumber() - 1000n
const toBlock = await publicClient.getBlockNumber()

const mintEvents = await getCollectionMintEvents(
  publicClient,
  collection.address,
  "ERC721",
  fromBlock,
  toBlock
)

console.log("è¿‘æœŸé“¸é€ ï¼š", mintEvents.map(event => ({
  minter: event.args.minter,
  tokenId: event.args.tokenId?.toString(),
  quantity: event.args.quantity?.toString(),
  blockNumber: event.blockNumber
})))
```

### å®æ—¶ç›‘æ§

```typescript title="å®æ—¶é“¸é€ ç›‘æ§"
// è§‚å¯Ÿæ–°çš„é“¸é€ äº‹ä»¶
const unwatch = publicClient.watchContractEvent({
  address: collection.address,
  abi: collection.abi,
  eventName: 'Transfer', // æˆ– 'TransferSingle' å¯¹äº ERC1155
  onLogs: (logs) => {
    logs.forEach(log => {
      console.log('æ£€æµ‹åˆ°æ–°é“¸é€ ï¼š', {
        from: log.args.from,
        to: log.args.to,
        tokenId: log.args.tokenId?.toString()
      })
    })
  }
})

// å®Œæˆååœæ­¢è§‚å¯Ÿ
// unwatch()
```

## æœ€ä½³å®è·µ

<CardGroup cols={2}>
  <Card title="ç”¨æˆ·ä½“éªŒ" icon="user">
    - åœ¨é“¸é€ è¿‡ç¨‹ä¸­æä¾›æ¸…æ™°çš„åé¦ˆ
    - é¢„å…ˆæ˜¾ç¤ºä¼°è®¡çš„ç‡ƒæ°”è´¹ç”¨
    - å®ç°é€‚å½“çš„åŠ è½½çŠ¶æ€
    - ä¼˜é›…åœ°å¤„ç†é”™è¯¯ï¼Œæä¾›ç”¨æˆ·å‹å¥½çš„æ¶ˆæ¯
  </Card>
</CardGroup>
