---
title: SDK å‚è€ƒ
description: BondKit SDK çš„å®Œæ•´ API å‚è€ƒï¼ŒåŒ…æ‹¬ç¤ºä¾‹å’Œ TypeScript å®šä¹‰ã€‚
lang: cn
originalPath: bondkit/sdk/reference.mdx
---
## å®‰è£…ä¸è®¾ç½®

<Tabs>
  <Tab title="NPM åŒ…">
    ```bash
    # ç”Ÿäº§ SDK
    pnpm add @b3dotfun/sdk
    
    # ä»ä¸» SDK å¯¼å…¥
    import { 
      BondkitTokenFactory, 
      BondkitToken 
    } from "@b3dotfun/sdk/bondkit";
    ```
  </Tab>
  <Tab title="å¼€å‘">
    ```bash
    # å…‹éš† monorepo
    git clone https://github.com/b3dotfun/b3-monorepo.git
    cd b3-monorepo
    pnpm install
    
    # æ„å»º SDK
    pnpm --filter @b3dotfun/sdk build
    ```
  </Tab>
</Tabs>

## æ ¸å¿ƒç±»

### BondkitTokenFactory

å·¥å‚ç±»å¤„ç†éƒ¨ç½²æ–°å€ºåˆ¸ä»£å¸å’ŒæŸ¥è¯¢å·²éƒ¨ç½²çš„ä»£å¸ã€‚

```typescript
import { BondkitTokenFactory } from "@b3dotfun/sdk/bondkit";
import { base } from "viem/chains";

const factory = new BondkitTokenFactory(
  base.id,                    // é“¾ IDï¼ˆBase ä¸»ç½‘ï¼‰
  process.env.WALLET_KEY      // å¯é€‰ï¼šå†™å…¥æ“ä½œçš„ç§é’¥
);
```

#### æ„é€ å‡½æ•°

```typescript
constructor(
  chainId: SupportedChainId,
  walletKey?: string
)
```

| å‚æ•°        | ç±»å‹     | å¿…é¡»çš„ | æè¿°                          |
|-----------|--------|------|-----------------------------|
| `chainId` | `number` | æ˜¯   | é“¾ IDï¼ˆå½“å‰ä»… Base: 8453ï¼‰    |
| `walletKey` | `string` | å¦   | å†™å…¥æ“ä½œçš„ç§é’¥                |

#### æ–¹æ³•

<AccordionGroup>
  <Accordion title="deployBondkitToken">
    **éƒ¨ç½²æ–°çš„å€ºåˆ¸ä»£å¸**
    
    ```typescript
    async deployBondkitToken(
      config: BondkitTokenConfig
    ): Promise<Address>
    ```
    
    **å‚æ•°ï¼š**
    ```typescript
    interface BondkitTokenConfig {
      name: string;                      // ä»£å¸åç§°
      symbol: string;                    // ä»£å¸ç¬¦å·
      feeRecipient: Address;            // æ¥æ”¶äº¤æ˜“è´¹ç”¨
      finalTokenSupply: bigint;         // æ€»ä¾›åº”é‡ï¼ˆ18 ä½å°æ•°ï¼‰
      aggressivenessFactor: number;     // 0-100 æ›²çº¿é™¡åº¦
      lpSplitRatioFeeRecipientBps: bigint; // LP è´¹ç”¨åˆ†äº«ï¼ˆåŸºç‚¹ï¼‰
      targetEth: bigint;                // è¿ç§»ç›®æ ‡ï¼ˆ18 ä½å°æ•°ï¼‰
      uniswapV2RouterAddress: Address;  // è·¯ç”±åœ°å€
      migrationAdminAddress: Address;   // å¯è§¦å‘è¿ç§»
    }
    ```
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    const tokenAddress = await factory.deployBondkitToken({
      name: "My Token",
      symbol: "MTK",
      feeRecipient: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb1",
      finalTokenSupply: parseEther("1000000"),
      aggressivenessFactor: 50,
      lpSplitRatioFeeRecipientBps: 1000n, // 10%
      targetEth: parseEther("10"),
      uniswapV2RouterAddress: "0x4752ba5DBc23f44D87826276BF6Fd6b1C372aD24",
      migrationAdminAddress: "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb1"
    });
    ```
  </Accordion>
  
  <Accordion title="getDeployedBondkitTokens">
    **è·å–æ‰€æœ‰å·²éƒ¨ç½²çš„ä»£å¸**
    
    ```typescript
    async getDeployedBondkitTokens(): Promise<Address[]>
    ```
    
    **è¿”å›ï¼š** ä»£å¸åœ°å€æ•°ç»„
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    const tokens = await factory.getDeployedBondkitTokens();
    console.log(`æ‰¾åˆ° ${tokens.length} ä¸ªä»£å¸`);
    ```
  </Accordion>
  
  <Accordion title="getBondkitTokenConfig">
    **è·å–ä»£å¸é…ç½®**
    
    ```typescript
    async getBondkitTokenConfig(
      tokenAddress: Address
    ): Promise<BondkitTokenConfig>
    ```
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    const config = await factory.getBondkitTokenConfig(
      "0x123..."
    );
    console.log(`ä»£å¸åç§°ï¼š${config.name}`);
    ```
  </Accordion>
  
  <Accordion title="getImplementationAddress">
    **è·å–å®ç°åˆçº¦**
    
    ```typescript
    async getImplementationAddress(): Promise<Address>
    ```
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    const impl = await factory.getImplementationAddress();
    console.log(`å®ç°ï¼š${impl}`);
    ```
  </Accordion>
  
  <Accordion title="connect">
    **è¿æ¥é’±åŒ…æä¾›è€…**
    
    ```typescript
    connect(provider?: EIP1193Provider): boolean
    ```
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    // æµè§ˆå™¨ç¯å¢ƒ
    const connected = factory.connect(window.ethereum);
    
    // è‡ªå®šä¹‰æä¾›è€…
    import { custom } from "viem";
    const transport = custom(provider);
    factory.connect(transport);
    ```
  </Accordion>
</AccordionGroup>

### BondkitToken

ä»£å¸ç±»å¤„ç†ç‰¹å®šå€ºåˆ¸ä»£å¸çš„æ‰€æœ‰æ“ä½œã€‚

```typescript
import { BondkitToken } from "@b3dotfun/sdk/bondkit";

const token = new BondkitToken(
  "0x123...",                 // ä»£å¸åœ°å€
  process.env.WALLET_KEY      // å¯é€‰ï¼šç§é’¥
);
```

#### æ„é€ å‡½æ•°

```typescript
constructor(
  contractAddress: string,
  walletKey?: string
)
```

| å‚æ•°              | ç±»å‹     | å¿…é¡»çš„ | æè¿°            |
|-----------------|--------|------|---------------|
| `contractAddress` | `string` | æ˜¯   | ä»£å¸åˆçº¦åœ°å€      |
| `walletKey`      | `string` | å¦   | å†™å…¥æ“ä½œçš„ç§é’¥    |

#### è¯»å–æ–¹æ³•

<AccordionGroup>
  <Accordion title="ERC20 æ ‡å‡†æ–¹æ³•">
    ```typescript
    // åŸºæœ¬ä»£å¸ä¿¡æ¯
    async name(): Promise<string>
    async symbol(): Promise<string>
    async decimals(): Promise<number>
    async totalSupply(): Promise<bigint>
    
    // ä½™é¢
    async balanceOf(address: Address): Promise<bigint>
    async allowance(
      owner: Address, 
      spender: Address
    ): Promise<bigint>
    
    // ç¤ºä¾‹
    const balance = await token.balanceOf(userAddress);
    console.log(`ä½™é¢ï¼š${formatEther(balance)}`);
    ```
  </Accordion>
  
  <Accordion title="å€ºåˆ¸æ›²çº¿æ–¹æ³•">
    ```typescript
    // å½“å‰æ¯ä¸ªä»£å¸çš„ä»·æ ¼
    async getCurrentBondingCurvePricePerToken(): Promise<bigint>
    
    // å½“å‰ä»¥ ETH è®¡ä»·çš„ä»·æ ¼
    async getCurrentPrice(): Promise<bigint>
    
    // è´­ä¹°æŠ¥ä»·
    async getAmountOfTokensToBuy(
      ethAmount: bigint
    ): Promise<bigint>
    
    // å‡ºå”®æŠ¥ä»·
    async getAmountOfEthToReceive(
      tokenAmount: bigint
    ): Promise<bigint>
    
    // å€ºåˆ¸è¿›åº¦
    async getBondingProgress(): Promise<{
      progress: number;      // 0-1ï¼ˆç™¾åˆ†æ¯”ï¼‰
      raised: bigint;       // ç­¹é›†é‡‘é¢
      threshold: bigint;    // ç›®æ ‡é‡‘é¢
    }>
    
    // ç¤ºä¾‹
    const progress = await token.getBondingProgress();
    console.log(`è¿›åº¦ï¼š${(progress.progress * 100).toFixed(2)}%`);
    ```
  </Accordion>
  
  <Accordion title="çŠ¶æ€ä¸é…ç½®">
    ```typescript
    // ä»£å¸çŠ¶æ€
    async getStatus(): Promise<TokenStatus>
    async isMigrated(): Promise<boolean>
    async canMigrate(): Promise<boolean>
    
    // é…ç½®
    async getOwner(): Promise<Address>
    async getFeeRecipient(): Promise<Address>
    async getAggressivenessFactor(): Promise<number>
    async getTargetAmount(): Promise<bigint>
    
    // è¿ç§»ä¿¡æ¯
    async getMigrationData(): Promise<{
      ethForLp: bigint;
      tokensForLp: bigint;
      sqrtPriceX96: bigint;
    }>
    
    // ç¤ºä¾‹
    if (await token.canMigrate()) {
      console.log("å‡†å¤‡è¿ç§»ï¼");
    }
    ```
  </Accordion>
  
  <Accordion title="åˆ†ææ–¹æ³•">
    ```typescript
    // ä»£å¸æŒæœ‰è€…
    async getPaginatedHolders(
      offset: number,
      limit: number
    ): Promise<{
      holders: Address[];
      total: number;
    }>
    
    // äº¤æ˜“å†å²ï¼ˆæ¥è‡ª APIï¼‰
    async getTransactionHistory(
      options?: GetTransactionHistoryOptions
    ): Promise<TransactionResponse>
    
    // é€‰é¡¹æ¥å£
    interface GetTransactionHistoryOptions {
      userAddress?: Address;
      type?: "buy" | "sell";
      from?: number;        // æ—¶é—´æˆ³
      to?: number;          // æ—¶é—´æˆ³
      limit?: number;       // 1-100
      offset?: number;
    }
    
    // ç¤ºä¾‹
    const history = await token.getTransactionHistory({
      type: "buy",
      limit: 10
    });
    ```
  </Accordion>
</AccordionGroup>

#### å†™å…¥æ–¹æ³•

<AccordionGroup>
  <Accordion title="buy">
    **ç”¨ ETH è´­ä¹°ä»£å¸**
    
    ```typescript
    async buy(
      minTokensOut: bigint,
      ethAmount: string | bigint
    ): Promise<Hex>
    ```
    
    **å‚æ•°ï¼š**
    - `minTokensOut`: æ¥æ”¶çš„æœ€å°‘ä»£å¸æ•°ï¼ˆé˜²æ­¢æ»‘ç‚¹ï¼‰
    - `ethAmount`: èŠ±è´¹çš„ ETHï¼ˆå­—ç¬¦ä¸²æˆ– bigintï¼‰
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    // å…ˆè·å–æŠ¥ä»·
    const quote = await token.getAmountOfTokensToBuy(
      parseEther("1")
    );
    
    // ä»¥ 5% çš„æ»‘ç‚¹å®¹å¿åº¦è´­ä¹°
    const minTokens = quote * 95n / 100n;
    const txHash = await token.buy(minTokens, "1");
    
    console.log(`äº¤æ˜“ï¼š${txHash}`);
    ```
  </Accordion>
  
  <Accordion title="sell">
    **å‡ºå”®ä»£å¸æ¢å– ETH**
    
    ```typescript
    async sell(
      tokenAmount: bigint,
      minEthOut: bigint
    ): Promise<Hex>
    ```
    
    **å‚æ•°ï¼š**
    - `tokenAmount`: å‡ºå”®çš„ä»£å¸æ•°é‡
    - `minEthOut`: æ¥æ”¶çš„æœ€å°‘ ETHï¼ˆé˜²æ­¢æ»‘ç‚¹ï¼‰
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    // å‡ºå”® 1000 ä»£å¸
    const sellAmount = parseEther("1000");
    
    // è·å–æŠ¥ä»·
    const quote = await token.getAmountOfEthToReceive(sellAmount);
    
    // å¸¦æœ‰æ»‘ç‚¹ä¿æŠ¤çš„å‡ºå”®
    const minEth = quote * 95n / 100n;
    const txHash = await token.sell(sellAmount, minEth);
    ```
  </Accordion>
  
  <Accordion title="migrateToDex">
    **è¿ç§»åˆ° Uniswap v4**
    
    ```typescript
    async migrateToDex(): Promise<Hex>
    ```
    
    **è¦æ±‚ï¼š**
    - è°ƒç”¨è€…å¿…é¡»æ˜¯è¿ç§»ç®¡ç†å‘˜
    - å¿…é¡»è¾¾åˆ°ç›®æ ‡
    
    **ç¤ºä¾‹ï¼š**
    ```typescript
    if (await token.canMigrate()) {
      const txHash = await token.migrateToDex();
      console.log(`è¿ç§»äº¤æ˜“ï¼š${txHash}`);
    }
    ```
  </Accordion>
  
  <Accordion title="ERC20 å†™å…¥æ–¹æ³•">
    ```typescript
    // æ ‡å‡†è½¬è´¦
    async transfer(
      to: Address,
      amount: bigint
    ): Promise<Hex>
    
    async transferFrom(
      from: Address,
      to: Address,
      amount: bigint
    ): Promise<Hex>
    
    // æˆæƒ
    async approve(
      spender: Address,
      amount: bigint
    ): Promise<Hex>
    
    // ç¤ºä¾‹
    await token.approve(
      spenderAddress,
      parseEther("1000")
    );
    ```
  </Accordion>
</AccordionGroup>

#### äº‹ä»¶ç›‘å¬å™¨

```typescript
// ç›‘å¬è´­ä¹°äº‹ä»¶
token.onBuy((event: BoughtEventArgs) => {
  console.log("è´­ä¹°ï¼š", {
    buyer: event.buyer,
    ethIn: formatEther(event.ethIn),
    tokensOut: formatEther(event.tokensOut),
    fee: formatEther(event.feeRecipientFee)
  });
});

// ç›‘å¬å‡ºå”®äº‹ä»¶
token.onSell((event: SoldEventArgs) => {
  console.log("å‡ºå”®ï¼š", {
    seller: event.seller,
    tokensIn: formatEther(event.tokensIn),
    ethOut: formatEther(event.ethOut),
    fee: formatEther(event.feeRecipientFee)
  });
});

// ç›‘å¬è¿ç§»
token.onMigration((event: DexMigrationEventArgs) => {
  console.log("å·²è¿ç§»ï¼š", {
    ethForLp: formatEther(event.ethForLp),
    tokensForLp: formatEther(event.tokensForLp)
  });
});
```

## ç±»å‹å®šä¹‰

### æ ¸å¿ƒç±»å‹

```typescript
// ä»£å¸é…ç½®
interface BondkitTokenConfig {
  name: string;
  symbol: string;
  feeRecipient: Address;
  finalTokenSupply: bigint;
  aggressivenessFactor: number;
  lpSplitRatioFeeRecipientBps: bigint;
  targetEth: bigint;
  uniswapV2RouterAddress: Address;
  migrationAdminAddress: Address;
}

// ä»£å¸çŠ¶æ€æšä¸¾
enum TokenStatus {
  Inactive = 0,
  BondingPhase = 1,
  DexPhase = 2,
  Migrated = 3
}

// ä»£å¸è¯¦æƒ…
interface TokenDetails {
  name: string;
  symbol: string;
  decimals: number;
  totalSupply: bigint;
  owner: Address;
}
```

### äº‹ä»¶ç±»å‹

```typescript
// è´­ä¹°äº‹ä»¶
interface BoughtEventArgs {
  buyer: Address;
  ethIn: bigint;
  tokensOut: bigint;
  feeRecipientFee: bigint;
}

// å‡ºå”®äº‹ä»¶
interface SoldEventArgs {
  seller: Address;
  tokensIn: bigint;
  ethOut: bigint;
  feeRecipientFee: bigint;
}

// è¿ç§»äº‹ä»¶
interface DexMigrationEventArgs {
  ethForLp: bigint;
  tokensForLp: bigint;
  ethForFeeRecipient: bigint;
}

// å·¥å‚åˆ›å»ºäº‹ä»¶
interface BondkitTokenCreatedEventArgs {
  tokenAddress: Address;
  implementationAddress: Address;
  name: string;
  symbol: string;
  feeRecipient: Address;
  migrationAdmin: Address;
}
```

### äº¤æ˜“ç±»å‹

```typescript
// äº¤æ˜“å†å²
interface Transaction {
  timestamp: number;
  price: number;
  amount: string;
  type: "buy" | "sell";
  userAddress: Address;
  txHash: Hex;
  chainId: number;
  blockNumber?: number;
  totalRaisedBonding?: string;
  value?: string;
}

// API å“åº”
interface TransactionResponse {
  total: number;
  limit: number;
  skip: number;
  data: Transaction[];
}
```

## é…ç½®

### ç½‘ç»œæ”¯æŒ

```typescript
import { getConfig } from "@b3dotfun/sdk/bondkit";
import { base } from "viem/chains";

const config = getConfig(base.id);

console.log({
  chain: config.chain.name,           // "Base"
  factoryAddress: config.factoryAddress,
  rpcUrl: config.rpcUrl,
  apiEndpoint: config.apiEndpoint
});
```

### æ”¯æŒçš„é“¾

| é“¾       | é“¾ ID   | çŠ¶æ€        |
|---------|--------|-----------|
| Base ä¸»ç½‘ | 8453  | âœ… æ”¯æŒ    |
| Base Sepolia | 84532 | ğŸš§ å³å°†æ¨å‡º |

## é”™è¯¯å¤„ç†

```typescript
try {
  const txHash = await token.buy(minTokens, "1");
} catch (error) {
  if (error.message.includes("insufficient funds")) {
    console.error("ETH ä¸è¶³");
  } else if (error.message.includes("slippage")) {
    console.error("ä»·æ ¼å˜åŠ¨ï¼Œè¯·é‡è¯•");
  } else if (error.message.includes("target exceeded")) {
    console.error("å°†è¶…è¿‡è¿ç§»ç›®æ ‡");
  } else {
    console.error("äº¤æ˜“å¤±è´¥ï¼š", error);
  }
}
```

## å®Œæ•´ç¤ºä¾‹

### éƒ¨ç½²å’Œäº¤æ˜“

```typescript
import { 
  BondkitTokenFactory, 
  BondkitToken 
} from "@b3dotfun/sdk/bondkit";
import { parseEther, formatEther } from "viem";
import { base } from "viem/chains";

async function deployAndTrade() {
  // 1. éƒ¨ç½²ä»£å¸
  const factory = new BondkitTokenFactory(
    base.id,
    process.env.WALLET_KEY
  );
  
  const tokenAddress = await factory.deployBondkitToken({
    name: "Test Token",
    symbol: "TEST",
    finalTokenSupply: parseEther("1000000"),
    aggressivenessFactor: 50,
    targetEth: parseEther("10"),
    feeRecipient: process.env.WALLET_ADDRESS,
    lpSplitRatioFeeRecipientBps: 1000n,
    migrationAdminAddress: process.env.WALLET_ADDRESS,
    uniswapV2RouterAddress: "0x4752ba5DBc23f44D87826276BF6Fd6b1C372aD24"
  });
  
  // 2. åˆå§‹åŒ–ä»£å¸å®¢æˆ·ç«¯
  const token = new BondkitToken(
    tokenAddress,
    process.env.WALLET_KEY
  );
  
  // 3. è´­ä¹°ä»£
