---
title: Fase de Vincula√ß√£o
description: 'Como funciona a compra e venda durante a fase de bonding, taxas e limites.'
lang: pt-BR
originalPath: bondkit/concepts/bonding-phase.mdx
---
## O que √© a Fase de Vincula√ß√£o?

A fase de vincula√ß√£o √© o per√≠odo inicial de negocia√ß√£o onde tokens s√£o comprados e vendidos diretamente de um contrato inteligente usando uma curva de precifica√ß√£o algor√≠tmica. Pense nisso como uma pr√©-venda descentralizada com cria√ß√£o de mercado autom√°tica.

```mermaid
stateDiagram-v2
    [*] --> Created: Token Deployed
    Created --> Bonding: Automatic
    Bonding --> Bonding: Buy/Sell Trades
    Bonding --> MigrationReady: Target Reached
    MigrationReady --> DEX: migrateToDex()
    DEX --> [*]: Fully Decentralized
    
    note right of Bonding
        - Direct contract trading
        - Algorithmic pricing
        - 5% trading fee
        - Accumulates liquidity
    end note
    
    note right of DEX
        - Uniswap v4 trading
        - Market-driven price
        - Standard LP fees
        - No admin control
    end note
```

## Como Funciona a Vincula√ß√£o

### O Mecanismo da Curva de Vincula√ß√£o

Durante a vincula√ß√£o, o contrato atua como o √∫nico formador de mercado:

1. **Sem Livro de Ordens**: Pre√ßos determinados algoritmicamente
2. **Liquidez Instant√¢nea**: Sempre poss√≠vel comprar ou vender
3. **Independ√™ncia de Caminho**: Pre√ßo depende apenas da oferta, n√£o do hist√≥rico
4. **Precifica√ß√£o Autom√°tica**: N√£o √© necess√°rio definir pre√ßos manualmente

## Opera√ß√µes de Negocia√ß√£o

### Comprando Tokens

<Tabs>
  <Tab title="Como Funciona">
    **Fluxo do Processo:**
    1. Usu√°rio envia ETH/B3 para o contrato
    2. Contrato calcula tokens baseado na curva
    3. Taxa de 5% deduzida e enviada ao destinat√°rio
    4. Tokens cunhados e enviados ao comprador
    5. Estado da curva atualizado
    
    **Exemplo de C√≥digo:**
    ```typescript
    // Obtenha uma cota√ß√£o primeiro
    const quote = await token.getAmountOfTokensToBuy(
      parseEther("1") // 1 ETH
    );
    console.log(`Will receive: ${formatEther(quote)} tokens`);
    
    // Execute a compra com prote√ß√£o contra deslizamento
    const minTokens = quote * 0.95n; // 5% de deslizamento
    await token.buy(minTokens, "1");
    ```
  </Tab>
  
  <Tab title="Par√¢metros">
    | Par√¢metro | Tipo | Descri√ß√£o |
    |-----------|------|-------------|
    | `minTokensOut` | uint256 | M√≠nimo de tokens a receber (prote√ß√£o contra deslizamento) |
    | `ethAmount` | string/uint256 | Quantidade de ETH a gastar |
    
    **Notas Importantes:**
    - Defina `minTokensOut` para proteger contra front-running
    - Use 0 para `minTokensOut` apenas em per√≠odos de baixa atividade
    - Transa√ß√£o reverte se o deslizamento exceder a toler√¢ncia
  </Tab>
  
  <Tab title="Casos de Borda">
    **Excedente do Alvo:**
    - Se a compra exceder o alvo, o excesso √© reembolsado
    - Exemplo: Alvo √© 10 ETH, arrecadado √© 9.5 ETH
    - Usu√°rio envia 1 ETH ‚Üí 0.5 ETH usado, 0.5 ETH reembolsado
    
    **G√°s Insuficiente:**
    - Limite de g√°s recomendado: 200,000
    - C√°lculos complexos podem requerer mais
    
    **Quantidade Zero:**
    - Transa√ß√µes com 0 ETH ser√£o revertidas
  </Tab>
</Tabs>

### Vendendo Tokens

<Tabs>
  <Tab title="Como Funciona">
    **Fluxo do Processo:**
    1. Usu√°rio autoriza gasto do token
    2. Usu√°rio chama sell com quantidade de tokens
    3. Contrato calcula ETH baseado na curva
    4. Taxa de 5% deduzida dos rendimentos
    5. ETH enviado ao vendedor, tokens queimados
    6. Estado da curva atualizado (pre√ßo diminui)
    
    **Exemplo de C√≥digo:**
    ```typescript
    // Verifique o saldo e obtenha uma cota√ß√£o
    const balance = await token.balanceOf(userAddress);
    const sellAmount = balance / 2n; // Vender metade
    
    const quote = await token.getAmountOfEthToReceive(
      sellAmount
    );
    console.log(`Will receive: ${formatEther(quote)} ETH`);
    
    // Execute a venda com prote√ß√£o contra deslizamento
    const minEth = quote * 0.95n; // 5% de deslizamento
    await token.sell(sellAmount, minEth);
    ```
  </Tab>
  
  <Tab title="Par√¢metros">
    | Par√¢metro | Tipo | Descri√ß√£o |
    |-----------|------|-------------|
    | `tokenAmount` | uint256 | Quantidade de tokens a vender |
    | `minEthOut` | uint256 | M√≠nimo de ETH a receber (prote√ß√£o contra deslizamento) |
    
    **Notas Importantes:**
    - Requer autoriza√ß√£o do token antes de vender
    - Impacto no pre√ßo pode ser significativo para vendas grandes
    - N√£o pode vender mais do que a oferta circulante
  </Tab>
  
  <Tab title="Impacto no Pre√ßo">
    **Entendendo o Impacto da Venda:**
    
    Vender reduz a quantidade arrecadada pela curva, causando queda no pre√ßo:
    
    | Tamanho da Venda | Impacto no Pre√ßo | Recupera√ß√£o Necess√°ria |
    |-----------|--------------|-----------------|
    | 1% da oferta | ~1-2% | Pequena |
    | 5% da oferta | ~5-10% | Moderada |
    | 10% da oferta | ~15-25% | Significativa |
    | 20% da oferta | ~30-50% | Grande |
    
    *O impacto real depende do fator de agressividade*
  </Tab>
</Tabs>

## Estrutura de Taxas

### Como Funcionam as Taxas

```mermaid
graph LR
    A[Negocia√ß√£o do Usu√°rio] -->|100%| B[Contrato]
    B -->|95%| C[Curva/Usu√°rio]
    B -->|5%| D[Destinat√°rio da Taxa]
    
    style A fill:#e1f5fe
    style D fill:#c8e6c9
```

<AccordionGroup>
  <Accordion title="Taxas de Compra">
    **Em uma compra de 1 ETH:**
    - 0.95 ETH vai para a curva de vincula√ß√£o
    - 0.05 ETH vai para o destinat√°rio da taxa
    - Tokens calculados com base no valor de 0.95 ETH
    
    **Exemplo:**
    ```typescript
    // Usu√°rio envia 1 ETH
    // Taxa: 0.05 ETH
    // Curva recebe: 0.95 ETH
    // Tokens cunhados com base em 0.95 ETH
    ```
  </Accordion>
  
  <Accordion title="Taxas de Venda">
    **Ao vender por um valor de 1 ETH:**
    - Usu√°rio recebe 0.95 ETH
    - 0.05 ETH vai para o destinat√°rio da taxa
    - Curva reduzida pelo 1 ETH completo
    
    **Exemplo:**
    ```typescript
    // Tokens valem 1 ETH na curva
    // Taxa: 0.05 ETH
    // Usu√°rio recebe: 0.95 ETH
    // Curva cai por 1 ETH
    ```
  </Accordion>
  
  <Accordion title="Distribui√ß√£o de Taxas">
    **Para onde v√£o as taxas:**
    - 100% para o endere√ßo `feeRecipient` designado
    - Pode ser o tesouro do projeto, desenvolvedor, ou DAO
    - Definido na cria√ß√£o do token, n√£o pode ser alterado
    
    **Reivindicando taxas:**
    - Autom√°tico - n√£o √© necess√°rio reivindicar
    - Enviado diretamente em cada negocia√ß√£o
    - Sem acumula√ß√£o no contrato
  </Accordion>
</AccordionGroup>

### Economia das Taxas

| Volume Di√°rio | Renda de Taxas | Renda Mensal |
|-------------|------------|----------------|
| 10 ETH | 0.5 ETH | ~15 ETH |
| 50 ETH | 2.5 ETH | ~75 ETH |
| 100 ETH | 5 ETH | ~150 ETH |
| 500 ETH | 25 ETH | ~750 ETH |

## Mec√¢nica do Alvo

### Entendendo o Alvo

O alvo √© a quantidade de ETH/B3 que deve ser acumulada antes da migra√ß√£o:

<Info>
  **Prop√≥sito do Alvo:**
  - Garante liquidez suficiente para o Uniswap v4
  - Cria um objetivo claro para a comunidade
  - Impede migra√ß√£o prematura
  - Constr√≥i momentum durante a vincula√ß√£o
</Info>

### Aproximando-se do Alvo

```typescript
// Monitorar progresso em dire√ß√£o ao alvo
async function trackProgress(token: BondkitToken) {
  const progress = await token.getBondingProgress();
  
  if (progress.progress < 0.5) {
    console.log("üå± Est√°gio inicial - melhores pre√ßos dispon√≠veis");
  } else if (progress.progress < 0.8) {
    console.log("üöÄ Momentum crescendo - considere comprar");
  } else if (progress.progress < 1.0) {
    console.log("üî• Quase l√° - migra√ß√£o iminente");
  } else {
    console.log("‚úÖ Alvo alcan√ßado - pronto para migrar!");
  }
  
  o restante = progress.threshold - progress.raised;
  console.log(`Precisa de mais ${formatEther(remaining)} ETH`);
}
```

### Tratamento de Excedente

Quando uma compra excederia o alvo:

1. **Preenchimento Parcial**: Apenas a quantidade necess√°ria √© aceita
2. **Reembolso Autom√°tico**: Excesso retornado na mesma transa√ß√£o
3. **Conclus√£o Justa**: Ningu√©m pode pagar a mais no final

**Cen√°rio de Exemplo:**
```
Alvo: 100 ETH
Atual: 99.5 ETH
Usu√°rio envia: 2 ETH

Resultado:
- 0.5 ETH aceito (atinge exatamente 100 ETH)
- 1.5 ETH reembolsado
- Usu√°rio recebe tokens por 0.5 ETH
- Migra√ß√£o agora dispon√≠vel
```

## Eventos & Monitoramento

### Eventos do Contrato

<Tabs>
  <Tab title="Evento de Compra">
    ```solidity
    event BondingCurveBuy(
        address indexed payer,
        address indexed recipient,
        uint256 tradingTokenIn,
        uint256 tokensOut,
        uint256 fee,
        uint256 totalRaisedBonding
    );
    ```
    
    **Ouvindo no SDK:**
    ```typescript
    token.onBuy((event) => {
      console.log({
        comprador: event.payer,
        ethGasto: formatEther(event.tradingTokenIn),
        tokensRecebidos: formatEther(event.tokensOut),
        taxaPaga: formatEther(event.fee),
        totalArrecadado: formatEther(event.totalRaisedBonding)
      });
    });
    ```
  </Tab>
  
  <Tab title="Evento de Venda">
    ```solidity
    event BondingCurveSell(
        address indexed seller,
        uint256 tokensIn,
        uint256 tradingTokenOut,
        uint256 fee,
        uint256 totalRaisedBonding
    );
    ```
    
    **Ouvindo no SDK:**
    ```typescript
    token.onSell((event) => {
      console.log({
        vendedor: event.seller,
        tokensVendidos: formatEther(event.tokensIn),
        ethRecebido: formatEther(event.tradingTokenOut),
        taxaPaga: formatEther(event.fee),
        totalArrecadado: formatEther(event.totalRaisedBonding)
      });
    });
    ```
  </Tab>
</Tabs>

### Monitoramento em Tempo Real

```typescript
// Configura√ß√£o completa de monitoramento
class BondingMonitor {
  constructor(private token: BondkitToken) {}
  
  async start() {
    // Estado inicial
    const progress = await this.token.getBondingProgress();
    console.log(`Iniciando em ${(progress.progress * 100).toFixed(2)}%`);
    
    // Monitorar compras
    this.token.onBuy(async (event) => {
      const newProgress = await this.token.getBondingProgress();
      console.log(`COMPRA: ${formatEther(event.tokensOut)} tokens`);
      console.log(`Progresso: ${(newProgress.progress * 100).toFixed(2)}%`);
      
      if (newProgress.progress >= 1.0) {
        console.log("üéÜ ALVO ATINGIDO! Migra√ß√£o dispon√≠vel.");
      }
    });
    
    // Monitorar vendas
    this.token.onSell(async (event) => {
      const newProgress = await this.token.getBondingProgress();
      console.log(`VENDA: ${formatEther(event.tokensIn)} tokens`);
      console.log(`Progresso: ${(newProgress.progress * 100).toFixed(2)}%`);
    });
  }
}

// Uso
const monitor = new BondingMonitor(token);
await monitor.start();
```

## Estrat√©gias da Fase de Vincula√ß√£o

### Para Criadores de Tokens

<CardGroup cols={2}>
  <Card title="Construir Momentum" icon="chart-line">
    - Comece com menor agressividade (30-50)
    - Defina alvos alcan√ß√°veis
    - Engaje a comunidade cedo
    - Forne√ßa um roteiro claro
  </Card>
  
  <Card title="Maximizar Sucesso" icon="trophy">
    - Semeie a liquidez inicial voc√™ mesmo
    - Crie incentivos para compra
    - Planeje an√∫ncios com cuidado
    - Planeje para p√≥s-migra√ß√£o
  </Card>
</CardGroup>

### Para Traders

<CardGroup cols={2}>
  <Card title="Estrat√©gia de Entrada" icon="door-open">
    - Compre cedo pelos melhores pre√ßos
    - Use DCA para grandes quantidades
    - Monitore o fator de agressividade
    - Verifique o progresso do alvo
  </Card>
  
  <Card title="Gest√£o de Risco" icon="shield">
    - Sempre use prote√ß√£o contra deslizamento
    - Entenda o impacto no pre√ßo
    - N√£o entre em FOMO perto do alvo
    - Planeje estrat√©gia de sa√≠da
  </Card>
</CardGroup>

## Transi√ß√£o P√≥s-Vincula√ß√£o

<Warning>
  **Cr√≠tico: Ap√≥s a Migra√ß√£o**
  
  Uma vez chamado `migrateToDex()`:
  - ‚ùå Negocia√ß√£o na curva de vincula√ß√£o permanentemente desabilitada
  - ‚ùå Nenhuma fun√ß√£o de buy() ou sell() mais
  - ‚úÖ Todas as negocia√ß√µes movem-se para o Uniswap v4
  - ‚úÖ Mec√¢nicas AMM padr√£o aplicam-se
  - ‚úÖ Qualquer um pode fornecer liquidez
  - ‚úÖ Negocia√ß√£o totalmente descentralizada
</Warning>

## Pr√≥ximos Passos

<CardGroup cols={3}>
  <Card title="Guia de Precifica√ß√£o" icon="tags" href="/bondkit/concepts/pricing">
    Entenda a mec√¢nica de pre√ßos
  </Card>
  <Card title="Defini√ß√£o de Alvo" icon="bullseye" href="/bondkit/concepts/targets">
    Escolha o alvo certo
  </Card>
  <Card title="Processo de Migra√ß√£o" icon="rocket" href="/bondkit/guides/migration">
    Aprenda sobre a transi√ß√£o para DEX
  </Card>
</CardGroup>
